\chapter{OUTILS MATH√âMATIQUES UTILIS√âS DANS LA RECONSTRUCTION D'IMAGES CT PAR LE COMPRESSED SENSING}

Un sujet tr√®s pr√©cis et int√©ressant ! La reconstruction d'images √† partir de projections est un aspect crucial de l'imagerie m√©dicale, en particulier dans des modalit√©s telles que la tomodensitom√©trie (CT) et la tomographie par √©mission de positons (TEP).
Le scanner de tomodensitom√©trie (CT) diagnostique, voir la \Cref{fig :tomography_device}, est un v√©ritable
chef-d'≈ìuvre de la technologie moderne et constitue un exemple positif de l'influence des forces
du march√© libre dans la stimulation de l'innovation. Tous les principaux fabricants de scanners
CT disposent d'√©quipes solides de recherche et d√©veloppement, qui suivent et contribuent aux
travaux de recherche en science de l'imagerie en plus de leurs activit√©s internes.

Les dispositifs CT peuvent √™tre consid√©r√©s comme la r√©alisation d'une cam√©ra gigapixel en usage
clinique courant. Alors qu'un scanner CT diagnostique moderne typique fournit des volumes
compos√©s de centaines d'images de coupes de taille $512 \times 512$ avec une r√©solution
submillim√©trique, les scanners micro-CT peuvent produire des volumes atteignant
$2000$ voxels.

Dans le cas de l'imagerie cardiaque par CT, une application qui a largement stimul√© les avanc√©es
technologiques, les images volumiques peuvent √™tre acquises avec une r√©solution temporelle
pouvant descendre jusqu'√† 100 millisecondes. La vitesse et la r√©solution de l'imagerie CT en font
un outil indispensable pour l'imagerie cardiaque et l'√©valuation des accidents vasculaires
c√©r√©braux.

Elle est utilis√©e de mani√®re routini√®re pour le diagnostic de diverses pathologies m√©dicales
affectant l'ensemble des organes internes, et son utilisation est m√™me envisag√©e comme outil de
d√©pistage du cancer du poumon. Les recherches actuelles visent globalement √† am√©liorer
l'utilit√© clinique sans augmenter la dose d'irradiation de l'examen, ou √† maintenir cette utilit√©
tout en r√©duisant l'exposition du patient aux rayonnements ionisants.

Les m√©thodes analytiques directes sont l'approche historique et math√©matiquement √©l√©gante des probl√®mes inverses lin√©aires \cite{14}, particuli√®rement en tomographie. Leur positionnement r√©pond √† un imp√©ratif de rapidit√© de calcul dans des applications o√π le temps de reconstruction est critique (imagerie m√©dicale clinique, contr√¥le non destructif industriel).

\section{Classification des approches de reconstruction}
Le paysage algorithmique de la tomographie se divise principalement en trois familles, distingu√©es par leur traitement de l'op√©rateur de projection.

\subsection{M√©thodes analytiques}
Les m√©thodes analytiques de reconstruction reposent sur une formulation math√©matique explicite
de l'inversion de l'op√©rateur direct reliant l'objet √† ses projections. En tomodensitom√©trie (TDM),
cet op√©rateur est √©troitement li√© √† la transform√©e de Radon. En exploitant ses propri√©t√©s, ces
m√©thodes permettent une reconstruction directe et rapide de l'image √† partir des donn√©es de
projection.

L'exemple le plus embl√©matique est la R√©troprojection Filtr√©e (\emph{Filtered Backprojection},
FBP). Cette m√©thode analytique largement utilis√©e consiste √† filtrer les projections avant de
les r√©troprojeter sur la grille de l'image. La FBP est rapide et efficace, mais elle demeure
sensible au bruit et aux artefacts, en particulier lorsque le nombre de projections est limit√©
ou que la dose d'irradiation est r√©duite.


\subsubsection{Fondements de la tomographie assist√©e par ordinateur (CT)}
Imaginons qu'on ait un objet opaque constitu√© de diff√©rents mat√©riaux, et que l'on souhaite savoir comment ces mat√©riaux sont r√©partis √† l'int√©rieur sans l'endommager (par exemple, l'objet peut √™tre un malade √† l'int√©rieur du corps duquel on aimerait voir). L'une des m√©thodes est le scanner  : on lance de fins faisceaux de rayons X √† travers l'objet dans toutes les directions et on mesure quelle proportion de chaque faisceau a √©t√© absorb√©e.

La tomographie est un proc√©d√© permettant de cr√©er l'image d'un objet en deux ou trois dimensions √† partir de multiples "coupes" unidimensionnelles (Voir \Cref{fig :tomography_device}). Dans un scanner CT, ces coupes sont d√©finies par des faisceaux de rayons $\mathbf{X}$ parall√®les projet√©s √† travers l'objet. En changeant l'orientation de la source et du d√©tecteur (l'angle \(\theta\)), on obtient des informations sur la densit√© interne sous diff√©rents angles.\\
Le fonctionnement repose sur la mesure de l'intensit√© des rayons $\mathbf{X}$ :
\begin{itemize}
    \item[-] \textbf{Perte d'√©nergie}  : Lorsqu'un rayon $\mathbf{X}$ traverse un objet, il perd une partie de son √©nergie, ce qui r√©duit son intensit√©
    \item[-] \textbf{Coefficient d'att√©nuation}  : Cette perte d√©pend de la densit√© du milieu. Les objets denses (comme l'os) provoquent une variation d'intensit√© plus importante que les tissus moins denses. Cette caract√©ristique est appel√©e le coefficient d'att√©nuation. L'att√©nuation mesur√©e pour chaque faisceau, c'est-√†-dire la diff√©rence entre l'intensit√© incidente et l'intensit√© d√©tect√©e, correspond √† une int√©grale de ligne de la structure interne de l'objet. Cette relation entre l'objet et l'ensemble de ses int√©grales de ligne est formalis√©e par la transform√©e de Radon. La reconstruction de l'image originale repose alors sur l'inversion de cette transform√©e, qui constitue le fondement th√©orique de la tomographie assist√©e par ordinateur
    \item[-] \textbf{Mesures}  : Le scanner enregistre l'intensit√© initiale √©mise ($I_{0}$) et l'intensit√© finale re√ßue ($I_{1}$) pour chaque faisceau afin de d√©duire la densit√© globale rencontr√©e sur le trajet
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/ct_device.png}
    \caption{Principe de fonctionnement d'un appareil de tomodensitom√©trie}
    \label{fig :tomography_device}
\end{figure}
\medskip
\noindent
D'un point de vue math√©matique, l'ensemble des mesures acquises par le scanner correspond √†
l'application de la transform√©e de Radon √† la fonction d'att√©nuation de l'objet. Le probl√®me
fondamental de la tomographie consiste alors √† reconstruire cette fonction d'att√©nuation √†
partir de ses int√©grales de ligne, c'est-√†-dire √† inverser la transform√©e de Radon.
Pour une fonction d'att√©nuation bidimensionnelle $A(x,y)$, la transform√©e de Radon est d√©finie
par :
\begin{equation}
\mathcal{R}\{A\}(\theta, s) =
\int_{\mathbb{R}^2} A(x,y)\,
\delta(x\cos\theta + y\sin\theta - s)\,\mathrm{d}x\,\mathrm{d}y,
\end{equation}
o√π $\theta$ repr√©sente l'angle de projection, $s$ la position du d√©tecteur, et $\delta(\cdot)$
la distribution de Dirac. Cette expression formalise le fait que chaque projection correspond
√† une int√©grale de la fonction d'att√©nuation le long d'une droite.

\subsubsection{Loi de Beer--Lambert et mod√©lisation de l'att√©nuation des rayons X dans l'objet}
L'objet initial, consid√©r√© comme plan, est donn√© par une fonction d'att√©nuation qui, √† chaque point du plan de coordonn√©es $(x, y)$, va associer un nombre $A(x, y)$ correspondant √† la proportion des rayons qui sont absorb√©s par le mat√©riau en ce point  : en un point d'un os, $A$ sera grand, et en un point de l'air, il sera faible.\vspace{10pt}\\
% \subsubsection{Loi de Beer--Lambert et mod√©lisation de l'att√©nuation}
En supposant dans un premier temps que la fonction d'att√©nuation de notre objet est constante √©gale √† $a$, pour tout rayon lumineux traversant notre objet, pour tout couple de points d'abscisses $x$ et $x+l$ sur ce rayon, les abscisses √©tant croissantes dans le sens du rayon, le rapport d'intensit√©s lumineuses $\cfrac{I(x+l)}{I(x)}$ ne d√©pend que de $a$ et de la longueur $l$ travers√©e et pas du point $x$ (position).

En omettant provisoirement la d√©pendance par rapport √† $a$ et en notant alors $p(l)$ ce rapport $\cfrac{I(x+l)}{I(x)}$ qui correspond √† la proportion de photons non
absorb√©s sur une longueur $l$ √† partir d'un point $x$, on voit que $p$ v√©rifie la propri√©t√© 
\[
    p(l_1+l_2) = p(l_1)p(l_2)
\] \vspace{10pt}\\
En Effet, la proportion de photons non absorb√©s sur une longueur $l_2$ √† partir d'un point $x+l_1$ est $\cfrac{I(x+l_1+l_2)}{I(x+l_1)}=p(l_2)$. Donc $p(l_1)p(l_2)=\cfrac{I(x+l_1)}{I(x)} \times \cfrac{I(x+l_1+l_2)}{I(x+l_1)}=p(l_1+l_2)$. Ceci traduit juste le fait simple suivant  : les proportions de photons non
absorb√©s se multiplient lors de travers√©es successives de milieux absorbants. La bonne d√©finition de l'att√©nuation est pr√©cis√©ment : 
\begin{equation}
    p(l)=e^{-a\, l}
    \label{eq:init_loi_beer_lambert_attenuation}
\end{equation}\vspace{10pt}\\
Autrement dit, pour tout $x$ et $x+l$ sur un axe  : 
\begin{equation}
    I(x+l)=I(x)e^{-a\, l}
    \label{eq:init_loi_beer_lambert}
\end{equation}\vspace{10pt}\\
Notons que si le ph√©nom√®ne physique d'att√©nuation est sp√©cifique de la tomographie √† rayons X, les m√©thodes de reconstruction sont en revanche plus g√©n√©rales et sont appliqu√©es √©galement dans d'autres syst√®mes d'imagerie, dans lesquelles des √©quations analogues expriment une fonction √† reconstruire en fonction de projections. C'est le cas par exemple de la TEP utilis√©e en m√©decine nucl√©aire.

\subsubsection{Reconstruction d'images en tomodensitom√©trie : inversion de Fourier, r√©troprojection et FBP}
√Ä partir de la mod√©lisation physique de l'att√©nuation et de la formulation math√©matique de la
transform√©e de Radon, plusieurs m√©thodes analytiques ont √©t√© propos√©es pour r√©soudre le
probl√®me inverse de la reconstruction tomographique.
La reconstruction d'images en tomodensitom√©trie √† partir des projections aux rayons X repose
classiquement sur trois grandes approches analytiques.\vspace{5pt} \\
La premi√®re est l'inversion directe de Fourier, fond√©e sur le th√©or√®me de la coupe de Fourier, selon lequel chaque projection acquise √†
un angle donn√© correspond √† une droite dans l'espace fr√©quentiel bidimensionnel de l'objet.
En th√©orie, l'acquisition d'un nombre suffisant de projections permet de remplir cet espace
fr√©quentiel et d'obtenir l'image par transformation de Fourier inverse. Toutefois, la n√©cessit√©
de r√©√©chantillonner des donn√©es organis√©es sur une grille polaire vers une grille cart√©sienne
rend cette m√©thode complexe et peu utilis√©e en pratique. \vspace{5pt} \\
La seconde approche consiste √† appliquer une r√©troprojection directe des projections, ce qui conduit √† une image floue,
√©quivalente √† la convolution de l'image originale avec un noyau de type
$1/\sqrt{x^2+y^2}$. La restauration de l'image n√©cessite alors une d√©convolution bidimensionnelle,
op√©ration co√ªteuse en temps de calcul. \vspace{5pt} \\ 
La troisi√®me m√©thode, la FBP, constitue l'approche la plus r√©pandue en pratique. Elle repose sur le
filtrage pr√©alable de chaque projection unidimensionnelle par un filtre rampe dans le domaine
fr√©quentiel, avant la r√©troprojection. Ce traitement permet de compenser le flou inh√©rent √† la
r√©troprojection (\cite{9}) tout en conservant une complexit√© de calcul r√©duite, puisque le filtrage est
effectu√© en une dimension. Ces m√©thodes analytiques supposent n√©anmoins la disponibilit√© d'un
grand nombre de projections uniform√©ment r√©parties, hypoth√®se qui n'est plus toujours valide
dans des contextes modernes tels que l'imagerie √† faible dose ou √† angles limit√©s, o√π des
approches it√©ratives bas√©es sur le \emph{Compressed Sensing} sont alors privil√©gi√©es.

\subsection{M√©thodes it√©ratives et Compressed Sensing}

La r√©duction des donn√©es de projection et de la dose de rayonnement en tomodensitom√©trie n'est
pas simplement une pr√©f√©rence de calcul ; elle est dict√©e par la s√©curit√© clinique, l'efficacit√©
op√©rationnelle et les contraintes physiques des syst√®mes d'imagerie par rayons \(\mathbf{X}\). 
Cette approche se justifie rigoureusement des points de vue m√©dical, physique et syst√©mique.

En premier lieu, la s√©curit√© des patients est primordiale : les rayons \(\mathbf{X}\) ionisants
utilis√©s en CT peuvent endommager l'ADN et augmenter le risque de cancer radio-induit,
en particulier chez les populations p√©diatriques ou lors d'expositions r√©p√©t√©es. Le mod√®le
lin√©aire sans seuil (LNT), pierre angulaire de la radioprotection, postule que toute
r√©duction de dose diminue proportionnellement le risque √† long terme. En pratique clinique
moderne, o√π les examens CT se multiplient (d√©pistage, suivi longitudinal, planification
radioth√©rapeutique), la r√©duction de la dose par acquisition est essentielle pour limiter
l'exposition cumulative.

D'un point de vue physique, la dose est approximativement proportionnelle au nombre de
projections et au produit courant-temps du tube. R√©duire l'un ou l'autre diminue donc
directement l'exposition, mais augmente le bruit quantique des donn√©es, rendant la
reconstruction plus difficile. Op√©rationnellement, un plus petit nombre de projections
raccourcit la dur√©e d'acquisition, r√©duisant les artefacts de mouvement et am√©liorant le
d√©bit patient. Pour les populations sensibles (enfants) ou dans des contextes d'imagerie
r√©p√©t√©e (radioth√©rapie guid√©e par l'image), cette r√©duction devient une obligation clinique
et √©thique, conforme au principe ALARA (As Low As Reasonably Achievable). Le d√©fi technique
r√©side dans la r√©solution du probl√®me de reconstruction sous-d√©termin√© qui en r√©sulte,
n√©cessitant des m√©thodes avanc√©es comme la reconstruction it√©rative ou le Compressed Sensing \cite{12}
pour pr√©server la qualit√© diagnostique malgr√© la r√©duction des donn√©es.

\subsubsection{Formulation g√©n√©rale du probl√®me inverse}
Dans ce contexte, la reconstruction tomographique peut √™tre formul√©e comme un
\textit{probl√®me inverse r√©gularis√©}. De mani√®re g√©n√©rale, un probl√®me inverse \cite{10} consiste
√† reconstruire un mod√®le √† partir de mesures indirectes issues d'un processus physique
connu. Le \textit{probl√®me direct} d√©crit la formation des donn√©es de projection √† partir
de l'image inconnue, tandis que le \textit{probl√®me inverse} vise √† retrouver cette image √†
partir des mesures acquises.\vspace{5pt}\\
En tomodensitom√©trie discr√®te, la relation entre l'image √† reconstruire et les donn√©es
de projection peut s'√©crire sous la forme d'un syst√®me lin√©aire :
\begin{equation}
    \mathbf{g} = \mathbf{H}\mathbf{f} + \boldsymbol{\varepsilon},
\end{equation}
o√π $\mathbf{f}$ repr√©sente l'image vectoris√©e, $\mathbf{g}$ les donn√©es de projection
(sinogramme), $\mathbf{H}$ la matrice du syst√®me mod√©lisant la transform√©e de Radon discr√®te \cite{11},
et $\boldsymbol{\varepsilon}$ un terme repr√©sentant le bruit de mesure.

Dans un cadre id√©al, l'op√©rateur $\mathbf{H}$ serait parfaitement inversible et les donn√©es
seraient compl√®tes et exemptes de bruit. En pratique, ces conditions ne sont jamais r√©unies.
Le probl√®me inverse est alors g√©n√©ralement \textit{mal pos√© au sens de Hadamard}, en raison
d'un manque d'unicit√© et surtout d'un fort manque de stabilit√© : de faibles perturbations du
bruit peuvent engendrer de grandes erreurs dans l'image reconstruite. Les m√©thodes it√©ratives
abordent ce probl√®me en recherchant une solution r√©gularis√©e, obtenue par la minimisation
d'une fonction de co√ªt combinant un terme d'ad√©quation aux donn√©es et un terme de
r√©gularisation incorporant des connaissances \emph{a priori} sur l'image.

\subsubsection{Principe du Compressed Sensing}
Le Compressed Sensing fournit un cadre math√©matique rigoureux pour la reconstruction de
signaux parcimonieux ou compressibles √† partir de mesures lin√©aires sous-√©chantillonn√©es,
sous certaines conditions sur l'op√©rateur de mesure. Il permet de r√©soudre des probl√®mes
inverses sous-d√©termin√©s au moyen de m√©thodes d'optimisation favorisant la parcimonie ou
d'algorithmes gloutons, avec des garanties th√©oriques de stabilit√© et de robustesse au bruit.

Dans le cadre de l'imagerie tomographique, le Compressed Sensing exploite l'id√©e que de
nombreuses images m√©dicales admettent une repr√©sentation parcimonieuse dans une base ou un
dictionnaire appropri√©, tel que les ondelettes ou le gradient de l'image. La reconstruction
est alors formul√©e comme un probl√®me d'optimisation sous contrainte :
\begin{equation}
    \min_{\mathbf{f}} \; \|\mathbf{\Psi}\mathbf{f}\|_1
    \quad \text{sous la contrainte} \quad
    \|\mathbf{H}\mathbf{f} - \mathbf{g}\|_2 \leq \delta,
\end{equation}
o√π $\mathbf{\Psi}$ d√©signe un op√©rateur favorisant la parcimonie et $\delta$ un param√®tre
li√© au niveau de bruit des donn√©es.

Cette formulation permet de reconstruire des images de qualit√© acceptable √† partir d'un
nombre de projections bien inf√©rieur √† celui requis par les m√©thodes analytiques classiques,
tout en assurant une certaine stabilit√© du probl√®me inverse.

\subsubsection{R√©gularisation et variation totale}
Une r√©gularisation particuli√®rement adapt√©e √† l'imagerie tomographique est la variation
totale (TV) \cite{13}, qui favorise les images compos√©es de r√©gions quasi uniformes s√©par√©es par des
discontinuit√©s nettes. La reconstruction TV est g√©n√©ralement formul√©e comme :
\begin{equation}
    \min_{\mathbf{f}} \;
    \frac{1}{2}\|\mathbf{H}\mathbf{f} - \mathbf{g}\|_2^2
    + \lambda \|\nabla \mathbf{f}\|_1,
\end{equation}
o√π $\nabla$ repr√©sente l'op√©rateur gradient discret et $\lambda$ un param√®tre de
r√©gularisation contr√¥lant le compromis entre fid√©lit√© aux donn√©es et stabilisation du
probl√®me inverse.

Cette approche permet de r√©duire efficacement le bruit tout en pr√©servant les contours,
qualit√© essentielle pour l'analyse diagnostique.

\subsubsection{Algorithmes it√©ratifs}
La r√©solution des probl√®mes d'optimisation issus du Compressed Sensing et des m√©thodes
variationnelles repose sur des algorithmes it√©ratifs, tels que les m√©thodes de descente de
gradient proximal, l'algorithme ISTA/FISTA, l'ADMM ou encore les m√©thodes de type primal-dual.
Ces algorithmes proc√®dent par mises √† jour successives de l'image estim√©e, alternant entre la
r√©duction de l'erreur de projection et l'application de la r√©gularisation.

Bien que plus co√ªteuses en temps de calcul que les m√©thodes analytiques, les m√©thodes
it√©ratives offrent une qualit√© de reconstruction sup√©rieure dans les sc√©narios de donn√©es
limit√©es et constituent aujourd'hui un axe majeur de recherche et de d√©veloppement en
tomodensitom√©trie moderne.

\subsubsection{Comparaison avec les m√©thodes analytiques}
En r√©sum√©, les m√©thodes analytiques privil√©gient la rapidit√© et la simplicit√© au prix d'une
sensibilit√© accrue au bruit et aux artefacts, tandis que les m√©thodes it√©ratives et bas√©es sur
le Compressed Sensing s'inscrivent pleinement dans le cadre des probl√®mes inverses
r√©gularis√©s. Elles exploitent des informations \emph{a priori} et des contraintes de parcimonie
pour am√©liorer la stabilit√© et la qualit√© de reconstruction dans des conditions d'acquisition
d√©grad√©es, r√©pondant ainsi aux exigences de s√©curit√© clinique et d'efficacit√© op√©rationnelle.


% ========================================================================================================
% TODO -> Phrase accrochage; mise en page; etc
% ========================================================================================================
% \section{Les traitements pr√©alables √† la reconstruction}

% \subsection{ M√©thodes dans le domaine spatial}
% % =================== TODO ==================
% \subsection{ Filtrage lin√©aire}
% % =========================================


% \subsection{ M√©thodes dans le domaine transform√©}
\section{ Transform√©e de Fourier}
La transform√©e de Fourier joue un r√¥le fondamental dans la reconstruction d'images en tomodensitom√©trie (CT), en permettant une analyse fr√©quentielle de l'image et des projections. Cette d√©composition facilite la distinction entre les structures globales, associ√©es aux basses fr√©quences, et les d√©tails fins, port√©s par les hautes fr√©quences, contribuant ainsi √† une reconstruction plus fid√®le. Son utilisation dans des algorithmes analytiques tels que la FBP permet de formuler le probl√®me dans le domaine fr√©quentiel, o√π les op√©rations de filtrage sont plus simples et plus efficaces √† mettre en ≈ìuvre num√©riquement. En particulier, l'application d'un filtre rampe aux projections unidimensionnelles permet de compenser le flou inh√©rent √† la r√©troprojection directe et de r√©duire des artefacts caract√©ristiques, tels que l'effet d'√©toile. En pratique, les donn√©es d'att√©nuation, organis√©es sous forme de sinogramme, sont transform√©es dans le domaine fr√©quentiel afin de contr√¥ler pr√©cis√©ment leur contenu spectral avant la reconstruction, ce qui conduit √† une am√©lioration globale de la qualit√© de l'image reconstruite.
\begin{definition}[Transform√©e de Fourier]
    Soit \( f \) une fonction absolument int√©grable sur \( \mathbb{R} \).
    La transform√©e de Fourier de \( f \), not√©e \( \mathcal{F}f \), est d√©finie
    pour tout nombre r√©el \( \xi \) par
    \[
    (\mathcal{F}f)(\xi)
    = \int_{-\infty}^{\infty} f(x)\, e^{-2\pi i \xi x}\, dx.
    \]
\end{definition}
La transform√©e de Fourier est fr√©quemment utilis√©e en analyse du signal et permet de transformer une fonction du temps en une fonction de la fr√©quence ; la variable $x$ repr√©sente le temps en secondes et la variable \( \xi \) repr√©sente la fr√©quence de la fonction en hertz. En fait, les transform√©es de Fourier indiquent des informations sur le signal. Elles montrent les d√©tails concernant la composante de fr√©quence qui appara√Æt ou est pr√©sente
dans le signal. Elles ne donnent pas de d√©tails sur la valeur exacte de la fr√©quence pr√©sente
√† cet instant pr√©cis.\\

Il existe une d√©finition alternative faisant intervenir la fr√©quence angulaire $w=2\pi \xi$, ce qui conduit √† l'expression suivante.
\[(\mathcal{F}f)(w) = \int_{-\infty}^{\infty} f(x)\, e^{-i w x}\, dx\]
Comme pour la transform√©e de Radon, nous allons √©num√©rer plusieurs propri√©t√©s de la transform√©e de Fourier.
\begin{proposition}
    Pour des constantes r√©elles $\alpha$ et $\beta$, et des fonctions absolument int√©grables $f$ et $g$, on a:
    \begin{itemize}
        \item[(i)] Lin√©arit√© : $\mathcal{F}(\alpha f + \beta g)(w) = \alpha \mathcal{F}f(w) + \beta \mathcal{F}g(w)$
        \item[(ii)] $\mathcal{F}f(w) < +\infty$
    \end{itemize}
\end{proposition}

\begin{definition}[Transform√©e de Fourier inverse]
Soit \( f \) une fonction absolument int√©grable.
La transform√©e de Fourier inverse de \( f \), not√©e \( \mathcal{F}^{-1}f \),
√©valu√©e en \( x \), est d√©finie par
\begin{equation}
    (\mathcal{F}^{-1}f)(x)
    = \cfrac{1}{2\pi}\int_{-\infty}^{\infty} f(w)\, e^{iw x}\, dw.
    \label{formula:fourier_inverse}
\end{equation}
\end{definition}
Ceci nous conduit imm√©diatement au th√©or√®me suivant.
\begin{proposition}[Th√©or√®me d'inversion de Fourier]
Soit $f$ une fonction absolument integrale sur $\mathbb{R}$.
Le th√©or√®me d'inversion de Fourier affirme que, pour tout \( x \),
\[
(\mathcal{F}^{-1} \circ \mathcal{F})f(x)=f(x)
\]
\end{proposition}
Jusqu'√† pr√©sent, nous n'avons abord√© la transform√©e de Fourier que dans une dimension. Il existe des d√©finitions correspondantes en dimensions sup√©rieures, mais, pour nos besoins, nous n'utiliserons que les analogues en deux dimensions.

\begin{definition}[Transform√©e de Fourier bidimensionnelle]
Soit \( g \) une fonction absolument int√©grable d√©finie sur \( \mathbb{R}^2 \).
La transform√©e de Fourier bidimensionnelle de \( g \), not√©e \( \mathcal{F}_2 g \),
est d√©finie pour tout \((X,Y) \in \mathbb{R}^2\) par
\begin{equation}
    (\mathcal{F}_2 g)(X,Y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} 
    g(x,y)\, e^{-i (xX + yY)} \, dx\, dy.
    \label{eq:fourier_2d}
\end{equation}

\end{definition}

De mani√®re similaire, nous d√©finissons la transform√©e de Fourier inverse sur $\mathbb{R}^2$.
\begin{definition}[Transform√©e de Fourier bidimensionnelle inverse]
Soit \( g \) une fonction absolument int√©grable d√©finie sur \( \mathbb{R}^2 \).
La transform√©e de Fourier bidimensionnelle inverse de \( g \), √©valu√©e en \((x,y)\)
et not√©e \( \mathcal{F}_2^{-1} g(x,y) \), est donn√©e par
\[
(\mathcal{F}_2^{-1} g)(x,y) = \cfrac{1}{4\pi^2}\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} 
g(X,Y)\, e^{i (xX + yY)} \, dX\, dY.
\]
\end{definition}

% ================== TODO ==================
% \subsection{ Filtre de Wiener}
% 1. Filtre de Wiener
% ‚úÖ Oui, tout √† fait applicable
% Le filtre de Wiener est un filtre lin√©aire adaptatif.

% Il peut √™tre appliqu√© :
%    - sur chaque projection (variable s)
%    - ou localement sur le sinogramme

% Int√©r√™t :
%    - r√©duction du bruit additif (souvent gaussien)
%    - compromis bruit / flou optimal au sens MSE

% ‚ö†Ô∏è Limites :
%    - n√©cessite une estimation du bruit et du spectre du signal
%    - un mauvais mod√®le d√©grade la reconstruction

% üìå Tr√®s utilis√© comme pr√©traitement des sinogrammes en CT √† faible dose.

% \subsection{ Curvelets}
% 4. Curvelets
% ‚úÖ Oui, tr√®s pertinent
% Les curvelets sont th√©oriquement bien adapt√©es :
%    - excellente repr√©sentation des singularit√©s le long de courbes

% Les lignes du sinogramme correspondent √† :
%    - des courbes li√©es aux bords de l'objet

% üìå Tr√®s utilis√© dans :
%    - CT basse dose
%    - Les m√©thodes variationnelles et it√©ratives
% =================================================
\subsection{Transform√©e de Fourier √† Court Terme (STFT)}

La STFT est plus avantageuse que la transform√©e de Fourier dans le sens o√π elle introduit la fen√™tre glissante. En fait, la fen√™tre sert √† extraire une petite partie du signal donn√©. Math√©matiquement, elle est repr√©sent√©e par :

\begin{equation}
    S f(u,\xi) = \int_{-\infty}^{\infty}f(t)\omega (t - u)exp(-j\xi t)dt \quad (3)
    \label{eq:stft}
\end{equation}



\section{Convolution}
La convolution joue un r√¥le cl√© dans la reconstruction d'image par r√©troprojection filtr√©e (FBP), car elle intervient directement dans l'√©tape de filtrage des projections. Avant la r√©troprojection, chaque projection mesur√©e est convolu√©e avec un filtre adapt√© afin de compenser le flou intrins√®que introduit par la r√©troprojection simple. Cette op√©ration permet de renforcer les hautes fr√©quences et d'am√©liorer la r√©solution de l'image reconstruite.

\textbf{D√©finition 8.1.}
Pour deux fonctions int√©grables $f$ et $g$ d√©finies sur $\mathbb{R}$,
nous d√©finissons la convolution de $f$ et $g$, not√©e $f \star g$, par
\[
(f \star g)(x) = \int_{-\infty}^{\infty} f(t)\,g(x - t)\,dt,
\]
o√π $x \in \mathbb{R}$.

Nous pouvons facilement √©tendre cette d√©finition √† l'espace
bidimensionnel. Pour les fonctions polaires, nous prenons uniquement
l'int√©grale par rapport √† la variable radiale, tandis que pour les
fonctions cart√©siennes nous int√©grons par rapport aux deux variables.
Les d√©finitions explicites sont donn√©es ci-dessous.

\begin{definition}
    Pour des fonctions polaires int√©grables $f(t,\theta)$ et $g(t,\theta)$,
    nous d√©finissons la convolution de $f$ et $g$ par
    \[
        (f \star g)(t,\theta)
        =
        \int_{-\infty}^{\infty}
        f(s,\theta)\,g(t - s,\theta)\,ds.
    \]
\end{definition}

Pour des fonctions int√©grables $F$ et $G$ sur $\mathbb{R}^2$,
nous d√©finissons la convolution de $F$ et $G$ par
\[
    (F \star G)(x,y)
    =
    \int_{-\infty}^{\infty}
    \int_{-\infty}^{\infty}
    F(s,t)\,G(x - s, y - t)\,ds\,dt.
\]

La convolution est une m√©thode math√©matique permettant de moyenner
une fonction $f$ √† l'aide du d√©placement d'une autre fonction $g$.
Dans la convolution $f \star g$, la fonction $g$ est translat√©e √† travers
la fonction $f$, et la fonction r√©sultante d√©pend de la zone de recouvrement
au cours de cette translation.
En un certain sens, on peut voir $g$ comme un filtre utilis√© pour effectuer
une moyenne de $f$ sur un intervalle donn√©.
La fonction de filtrage agit ainsi comme un lisseur pour les donn√©es bruit√©es
fournies par la fonction originale.

\begin{proposition}
    Pour des fonctions int√©grables $f$, $g$, $h$ d√©finies sur $\mathbb{R}$
    et des constantes $\alpha, \beta \in \mathbb{R}$ :
    
    \begin{itemize}
      \item[(i)] $f \star g = g \star f$ \quad (commutativit√©),
      \item[(ii)] $f \star (\alpha g + \beta h)
      = \alpha (f \star g) + \beta (f \star h)$ \quad (lin√©arit√©).
      \item[(iii)] $\mathcal{F}(f). \mathcal{F}(g)  = \mathcal{F}(f \star g)$
    \end{itemize}
\end{proposition}


% =================================================
\section{Transform√©e de Radon}
% =================================================
L'hypoth√®se fondamentale est que le d√©tecteur mesure l'att√©nuation int√©gr√©e le long d'un rayon. 
\begin{definition}
    Pour un faisceau de rayons $\mathbf{X}$ d'√©nergie $\mathbf{E}$ donn√©e et un taux de propagation des photons $\mathbf{N}(x)$, l'intensit√© du faisceau $\mathbf{I}(x)$ √† une distance $x$ de l'origine est d√©finie comme \[\mathbf{I}(x) = \mathbf{N}(x) \mathbf{E}\]
\end{definition}

\begin{definition}
    La proportion de photons absorb√©s par millim√®tre de substance √† une distance $x$ de l'origine est appel√©e le coefficient d'att√©nuation $\mathbf{A}(x)$ du milieu.
\end{definition}


Nous connaissons les intensit√©s initiale et finale, $I_0$ et $I_1$ d'un faisceau unique. L'objectif est d'utiliser ces intensit√©s pour d√©terminer le coefficient d'att√©nuation le long du trajet du faisceau. Heureusement, la loi de Beer-Lambert √©tablit une relation entre ces deux grandeurs.

\begin{definition}[Loi de Beer-Lambert]
Pour un faisceau de rayons X monochromatique, non r√©fractif et de largeur nulle,
traversant un milieu homog√®ne sur une distance \(x\) √† partir de l'origine,
l'intensit√© \(I(x)\) est donn√©e par
\begin{equation}
    I(x) = I_0 e^{-\mathbf{A}(x)x}
    \label{eq:loi_beer_lambert}
\end{equation}
\end{definition}
En l'√©tat, cette √©quation ne nous est pas particuli√®rement utile. Elle exprime le coefficient d'att√©nuation en un point donn√© en fonction de l'intensit√© en ce point, alors que nous ne connaissons la valeur de l'intensit√© qu'en des points situ√©s √† l'ext√©rieur de l'objet. Ce que nous cherchons r√©ellement est une relation entre le coefficient d'att√©nuation √† l'int√©rieur de l'objet et la variation de l'intensit√© du faisceau. Pour cela, nous allons manipuler l√©g√®rement l'√©quation \eqref{eq:loi_beer_lambert}.\\
En passant √†  la d√©riv√©e de la loi de Beer-Lambert, nous obtenons la relation suivante :
\[
    \frac{dI}{dx} = -\mathbf{A}(x)I(x)
\]
Soit $I(x_0)=I_0$ la valeur initiale de l'intensit√© du faisceau et $I(x_1)=I_1$ la valeur finale de l'intensit√© du faisceau. En utilisant cette relation, nous obtenons la relation suivante :

\[
    -\int_{x_0}^{x_1} \mathbf{A}(x)dx = \int_{x_0}^{x_1}\cfrac{dI}{I(x)}=ln(\frac{I_1}{I_0})
\]
ou encore \vspace{10pt}
\begin{equation}
    \int_{x_0}^{x_1} \mathbf{A}(x)dx = ln(\frac{I_0}{I_1})
    \label{eq:radon_transformation}
\end{equation}

$ln(\frac{I_0}{I_1})$ d√©signe les donn√©es de projection, commun√©ment appel√©es le sinogramme, qui r√©sultent de l'acquisition des projections tomographiques.
\medskip
\noindent
Nous sommes maintenant pr√™ts √† introduire des outils math√©matiques ‚Äî en particulier la transform√©e de Radon ‚Äî qui joueront un r√¥le central dans la d√©termination du coefficient d'att√©nuation dans l'√©quation \eqref{eq:loi_beer_lambert}.

L'√©criture sous forme normale d'une √©quation de droite joue un r√¥le cl√© dans la transform√©e de Radon, car elle permet une param√©trisation naturelle et compl√®te de toutes les droites du plan, ce qui est essentiel pour la d√©finition math√©matique et le calcul pratique de cette transformation.\\ 
Cette √©quation sous forme normale fournit :
\begin{itemize}
    \item[(i)] Une param√©trisation unique et continue de toutes les droites du plan. La forme normale (ou forme normale de Hesse) de l'√©quation de la droite s'√©crit : $$x\,\cos(\theta)+y\,\sin(\theta)=\rho$$ o√π $\rho$ est la distance par rapport √† l'origine et $\theta$ est l'angle par rapport √† l'axe des abscisses.
    \item[(ii)] Une interpr√©tation g√©om√©trique claire de $\rho$ et $\theta$. Chaque droite du plan correspond  √† un unique couple ($\rho,\theta$). Cette param√©trisation √©vite les redondances et garantit qu'on parcourt toutes les droites une et une seule fois (√† une convention pr√®s).
    \item[(iii)] Une mesure naturelle sur l'espace des droites, utilis√©e dans les formules d'inversion.
    \item[(iv)] Un formalisme adapt√© au th√©or√®me de coupe, reliant transform√©e de Radon et transform√©e de Fourier 2D. 
    \item[(v)] Une mesure naturelle sur l'espace des droites, utilis√©e dans les formules d'inversion.
\end{itemize}\vspace{10pt}
\subsection{\small Construction de l'orientation et de la distance}
Nous connaissons tous l'id√©e qu'une droite \( l \) dans \( \mathbb{R}^2 \) peut √™tre repr√©sent√©e par l'√©quation 
\[
ax + by = c
\]
o√π \( a, b, c \in \mathbb{R} \) et \( a^2 + b^2 \neq 0 \).\\ On peut alors √©crire cette √©quation d'une droite sous la forme \[w_1x + w_2y = t\]
o√π $\mathbf{w}:=(w_1, w_2) = (\cfrac{a}{\sqrt{a^2 + b^2}}, \cfrac{b}{\sqrt{a^2 + b^2}})$ et $t=\cfrac{c}{\sqrt{a^2 + b^2}}$, que nous pouvons voir comme un point situ√© sur le
cercle unitaire, pour \[\left(\cfrac{a}{\sqrt{a^2 + b^2}}\right)^{2} + \left(\cfrac{b}{\sqrt{a^2 + b^2}}\right)^{2} = 1\]
Cela implique que $\mathbf{w} := (\cos(\theta), \sin(\theta)) \text{ est un vecteur normal unitaire }$, $\theta \in [0, 2\pi)$ repr√©sente l'orientation, et $t$ est exactement la distance √† l'origine. On a \[x\cos(\theta) + y\sin(\theta) = t\]
Notez que dans les √©quations ci-dessus, $t$ et $\theta$ sont fixes et d√©terminent une droite sp√©cifique \( l \) dans le plan. On peut donc dire que $t$ et $\theta$ param√®trent une droite \( l_{t,\theta} \) et que $\mathbf{z}$ d√©termine des points sp√©cifiques sur cette droite \( l \). Ou encore
\[l_{t,\theta} = \{ \mathbf{z} \in \mathbb{R}^2 : \langle z, (\cos \theta, \sin \theta) \rangle = t \}.\]
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/l_t_theta.png}
    \caption{param√®trisation d'une droite \( l_{t,\theta} \) par \( t \) et \( \theta \)}
    \label{fig:l_t_theta}
\end{figure}
On voit  que $(t\, \cos(\theta), t\, \sin(\theta))$ est un point situ√© sur la droite \( l_{t,\theta} \) (\Cref{fig:l_t_theta}) et $(-\sin(\theta), \cos(\theta))$ est un vecteur perpendiculaire au vecteur unitaire $\mathbf{w}$.\\ En g√©om√©trie affine √©l√©mentaire, une ligne est un point plus une direction. Par cons√©quent, nous pouvons d√©crire un point particulier $(x, y)$ sur $l_{t, \theta}$ en termes de nombre r√©el s comme suit :
\begin{equation}
    l_{t, \theta} = \{(t\, \cos(\theta) - s\,\sin(\theta), t\,\sin(\theta) + s\,\cos(\theta)); s\in \mathbb{R}\}
    \label{set:l_t_theta}
\end{equation}
\begin{definition}[Transform√©e de Radon]
Soit \( f(t,\theta) \) une fonction d√©finie sur \( \mathbb{R}^2 \) √† support compact.
La transform√©e de Radon de \( f \), not√©e \( \mathcal{R}f \), est d√©finie pour
\( t \in \mathbb{R} \) et \( \theta \in (0, 2\pi] \) par
\[
\mathcal{R}f(t,\theta) = \int_{-\infty}^{\infty} f(x(s),y(x))\mathrm{d}s
\]
\end{definition}

La transform√©e de Radon permet de d√©terminer la densit√© totale d'une fonction $f$ le long d'une droite donn√©e $l$. Cette droite $l$ est d√©finie par un angle $\theta$  par rapport √† l'axe 
$x$ et une distance $t$ par rapport √† l'origine. Comme illustr√© √† la \Cref{fig:radon}, si l'on calcule la transform√©e de Radon le long de plusieurs droites √† des angles diff√©rents (ici $\theta_1$ et $\theta_2$), on peut d√©terminer plusieurs fonctions de densit√© pour notre objet. Intuitivement, on peut interpr√©ter la transform√©e de Radon comme une version ¬´ √©tal√©e ¬ª de notre objet initial. Supposons que la r√©gion en forme de tache repr√©sent√©e √† la \Cref{fig:radon} soit une tache d'encre; si l'on √©tale cette tache le long de lignes de direction $\theta_1$, on s'attend √† ce que les r√©gions les plus larges de la tache correspondent √† des zones plus √©tendues que les r√©gions plus petites, ce qui correspond exactement √† ce que l'on observe.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/radon.png}
    \caption{Transform√©e de Radon pour $\theta_1$ et $\theta_2$.}
    \label{fig:radon}
\end{figure}
L'int√©grale $\mathcal{R}f(t,\theta)$ repr√©sente le membre gauche de l'√©quation \eqref{eq:radon_transformation}. Rappelons que, dans cette √©quation, $\mathbf{A}(x)$ est inconnue et que $\ln(\frac{I_1}{I_0})$ correspond √† une information mesur√©e.
Autrement dit, $\ln(\frac{I_1}{I_0})$ est la transform√©e de Radon, et la transform√©e de Radon repr√©sente donc des donn√©es connues issues de la mesure.

L'objectif est maintenant de trouver une formule d'inversion de la transform√©e de Radon qui nous permettra de reconstruire la fonction initiale $f$ (ou, dans le contexte de l'imagerie m√©dicale, 
$\mathbf{A}(x)$). Pour ce faire, il sera utile de rappeler plusieurs propri√©t√©s de la transform√©e de Radon.
\begin{proposition}
    Soit $\alpha$ et $\beta$ deux r√©els et $f$ et $g$ deux fonctions continues sur $\mathbb{R}^2$ √† support compact. On a
    \begin{itemize}
        \item[(i)] Lin√©arit√© : $\mathcal{R}(\alpha f + \beta g) = \alpha \mathcal{R}f + \beta \mathcal{R}g$
        \item[(ii)] Parit√©: $\mathcal{R}f(-t,-\theta) = \mathcal{R}f(t,\theta)$
        \item[(iii)] $\mathcal{R}f(t, \theta) = \int_{-\infty}^{\infty} f(x(s), y(s))\mathrm{d}s = \int_{-\infty}^{\infty} f(t\,cos(\theta)-s\,sin(\theta), t\,sin(\theta)+s\,cos(\theta))\mathrm{d}s$
        % \item[(iv)] Invariance par rotation : \(\mathcal{R}(f \circ R_{\psi}) = \mathcal{R}f(t,\theta - \psi)\)
        % \item[(v)] Relation avec la convolution : \(\mathcal{R}(f * g) = \mathcal{R}f * \mathcal{R}g\)
    \end{itemize}
\end{proposition}
Nous d√©finissons en outre le domaine naturel de la transform√©e de Radon comme l'ensemble des fonctions $f$ sur $\mathbb{R}^2$ telles que \[\int_{-\infty}^{\infty} |f(x(s), y(s))|\mathrm{d}s < \infty\]

\subsection{Th√©or√®me de la Coupe Centrale}
Le th√©or√®me de la coupe centrale, √©galement appel√© th√©or√®me de projection-transforme de Fourier ou th√©or√®me de Fourier-Slice, est un r√©sultat fondamental en traitement d'image et en tomographie. Il √©tablit un lien profond entre la transform√©e de Radon (utilis√©e pour d√©crire les projections d'un objet) et la transform√©e de Fourier (utilis√©e pour analyser les fr√©quences spatiales). Ce th√©or√®me constitue la pierre angulaire math√©matique de la plupart des m√©thodes de reconstruction tomographique moderne.

\begin{proposition}
    Soit \( g \) une fonction absolument integrale sur \( \mathbb{R}^2 \).
    Le th√©or√®me de la coupe centrale affirme que, pour tout $S \in \mathbb{R}$ et $\theta \in [0,2\pi]$, on a : \[\mathcal{F}_2 g(S\cos(\theta), S\sin(\theta)) = \mathcal{F}(\mathcal{R}g)(S, \theta)\]
\end{proposition}
\textbf{Preuve}: En utilisant la d√©finition de la transform√©e de Fourier bidimensionnelle \eqref{eq:fourier_2d} on obtient 
\[
    \mathcal{F}_{2}g(S\,\cos(\theta), S\,\sin(\theta)) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y)\, e^{-iS (x\,\cos(\theta) + y\,\sin(\theta))}\, dx\, dy
\]
Nous effectuons maintenant un changement de variables conform√©ment au syst√®me
de coordonn√©es que nous avons d√©fini √† la \textit{Construction de l'orientation et de la distance}.
Rappelons que, lors de la param√©trisation de la droite $\ell_{t,\theta}$,
nous avons montr√© que, pour $s\in\mathbb{R}$, on peut √©crire :
\[
x(s)=t\cos\theta - s\sin\theta, 
\qquad
y(s)=t\sin\theta + s\cos\theta,
\qquad
t = x\cos\theta + y\sin\theta.
\]

En examinant le d√©terminant du Jacobien associ√© √† $x(s)$ et $y(s)$, on obtient :
\[
\det
\begin{pmatrix}
\dfrac{\partial x}{\partial t} & \dfrac{\partial x}{\partial s} \\[6pt]
\dfrac{\partial y}{\partial t} & \dfrac{\partial y}{\partial s}
\end{pmatrix}
= 1.
\]

Nous en d√©duisons que
\[
ds\,dt = dx\,dy.
\]
et donc
\[
\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y)\, e^{-iS (x\,\cos(\theta) + y\,\sin(\theta))}\, dx\, dy = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
g(t\cos\theta - s\sin\theta,\; t\sin\theta + s\cos\theta)\,
e^{-iSt}\,ds\,dt.
\]

Comme $e^{-iSt}$ ne d√©pend pas de la variable $s$, nous pouvons r√©arranger
l'int√©grale pr√©c√©dente de la mani√®re suivante :
\[
\int_{-\infty}^{\infty}
\left(
\int_{-\infty}^{\infty}
g(t\cos\theta - s\sin\theta,\; t\sin\theta + s\cos\theta)\,ds
\right)
e^{-iSt}\,dt.
\]

L'int√©grale int√©rieure est exactement la transform√©e de Radon de $f$,
√©valu√©e en $(t,\theta)$, ce qui implique que l'expression pr√©c√©dente devient :
\[
\int_{-\infty}^{\infty}
(Rg(t,\theta))\,e^{-iSt}\,dt.
\]

Cette derni√®re int√©grale n'est autre que la transform√©e de Fourier de
$Rg(S,\theta)$, ce qui conclut la d√©monstration.
\hfill$\square$

% \section{Inversion analytique de la transform√©e de Radon}
\subsection{R√©troprojection filtr√©e (FBP)}
Nous sommes maintenant enfin pr√™ts √† effectuer une premi√®re tentative pour retrouver la fonction de coefficient d'att√©nuation.
Rappelons que, d'un point de vue physique, la transform√©e de Radon
$\mathcal{R}f(t,\theta)$ nous donne la densit√© totale de l'objet $f$ le long d'une droite
$\ell_{t,\theta}$.
Nous avons d√©termin√© cette densit√© en mesurant les intensit√©s initiale et finale
d'un faisceau de rayons $\mathbf{X}$ traversant l'objet le long de cette droite.
En proc√©dant ainsi pour plusieurs droites diff√©rentes, nous sommes capables de
reconstruire une coupe unique de l'objet initial, et en faisant varier l'angle
$\theta$ de ces rayons $\mathbf{X}$, nous pouvons d√©finir de nombreuses coupes.

Si nous sommes capables, d'une certaine mani√®re, de ¬´ r√©troprojeter ¬ª ces
densit√©s sur le plan, nous pourrons peut-√™tre reconstituer l'objet initial.
Intuitivement, on peut interpr√©ter ce processus comme le fait de prendre les
donn√©es du sinogramme et de les ¬´ d√©flouter ¬ª pour les ramener dans le plan.
\begin{definition}
Soit $h = h(t,\theta)$. On d√©finit la \emph{r√©troprojection},
not√©e $\mathcal{B}h$, en un point $(x,y)$ par :
\[
\mathcal{B}h(x,y) = \frac{1}{\pi}\int_{0}^{\pi} h(x\cos\theta + y\sin\theta,\theta)\,d\theta.
\]

En appliquant cette formule de r√©troprojection √† la transform√©e de Radon, on
obtient :
\begin{equation}
    \mathcal{B}\mathcal{R}f(x,y) = \frac{1}{\pi}\int_{0}^{\pi}
    \mathcal{R}f(x\cos\theta + y\sin\theta,\theta)\,d\theta.
    \label{eq:FBP}
\end{equation}
\end{definition}
Nous sommes capables d'effectuer la r√©troprojection sur les coupes que nous
avons mesur√©es. Comme illustr√© √† la \Cref{fig:FBP}, effectuer une r√©troprojection
selon seulement quelques directions $\theta$ constitue une m√©thode extr√™mement
impr√©cise pour reconstituer ne serait-ce qu'un objet simple. Toutefois, m√™me si
nous augmentons de mani√®re significative le nombre de r√©troprojections
(par exemple jusqu'√† $1000$ directions), il subsiste encore une quantit√©
importante de bruit qui brouille l'image reconstruite.
En r√©alit√©, quel que soit le nombre de directions selon lesquelles nous tentons
d'effectuer la r√©troprojection, nous ne serons jamais capables de reconstruire
parfaitement l'image √† l'aide de la formule de r√©troprojection donn√©e par
l'√©quation \eqref{eq:FBP}.
Pour que ce proc√©d√© soit r√©ellement utile, il est n√©cessaire de d√©river une
m√©thode permettant de filtrer une partie du bruit que la formule de
r√©troprojection semble introduire dans l'image, afin d'obtenir une
repr√©sentation plus lisse de l'objet.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/fbp.png}
    \caption{Retroprojection d'un carr√© dans 5, 25, 100 et 1000 directions}
    \label{fig:FBP}
\end{figure}

Dans ce but, nous d√©finissons une formule de \emph{r√©troprojection filtr√©e}.
\begin{proposition}
    Soit $f$ une fonction absolument int√©grable d√©finie sur $\mathbb{R}^2$. Alors,
    \begin{equation}
        f(x,y)
        =
        \frac{1}{2}\,
        \mathcal{B}\!\left\{
        \mathcal{F}^{-1}
        \!\left[
        |S|\,
        \mathcal{F}\!\left(\mathcal{R}f\right)(S,\theta)
        \right]
        \right\}(x,y).
        \label{eq:FBP_filter}
    \end{equation}
\end{proposition}
\textit{D√©monstration.}
Nous commen√ßons par rappeler que, pour la transform√©e de Fourier bidimensionnelle
et son inverse, on a :
\begin{equation}
f(x,y) = \mathcal{F}_2^{-1}\,\mathcal{F}_2 f(x,y)
= \frac{1}{4\pi^2}
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
\mathcal{F}_2 f(X,Y)\,e^{i(Xx+Yy)}\,dX\,dY.
\label{eq:fourier_2d_inverse}
\end{equation}

Nous allons maintenant effectuer un changement de variables des coordonn√©es
cart√©siennes $(X,Y)$ vers les coordonn√©es polaires $(S,\theta)$, d√©finies par
\[
X = S\cos\theta,
\qquad
Y = S\sin\theta,
\]
o√π $S \in \mathbb{R}$ et $\theta \in [0,\pi]$.
Ce changement de variables conduit au d√©terminant jacobien suivant :
\[\det
\begin{pmatrix}
    \dfrac{\partial X}{\partial s} & \dfrac{\partial X}{\partial \theta} \\[6pt]
    \dfrac{\partial Y}{\partial s} & \dfrac{\partial Y}{\partial \theta}
\end{pmatrix}
=|S|
\]
Ce qui nous dit que $dX\,dY = |S|\,dS\,d\theta$. En incorporant ce nouveau changement de variables, l'√©quation \eqref{eq:fourier_2d_inverse} devient :
\[
f(x,y) = \frac{1}{4\pi^{2}} \int_{0}^{\pi} \int_{-\infty}^{\infty}
\mathcal{F}_{2}f(S\cos\theta, S\sin\theta)\,
e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS\,d\theta.
\]
Et en utilisant le th√©or√®me de la tranche centrale, nous voyons que l'√©quation ci-dessus est en fait √©gale √†
\begin{equation}
    f(x,y) = \frac{1}{4\pi^{2}} \int_{0}^{\pi} \int_{-\infty}^{\infty}
    \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
    e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS\,d\theta.
    \label{eq:fourier_radon}
\end{equation}
Prenons maintenant un regard plus attentif sur l'int√©grale int√©rieure de l'√©quation \eqref{eq:fourier_radon} et en utilisant la d√©finition de la Transform√©e de Fourier inverse, on a :
\[
    \begin{array}{rcl}
        \int_{-\infty}^{\infty}
        \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
        e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS
        &=&
        2\pi \left(
        \frac{1}{2\pi} \int_{-\infty}^{\infty}
        \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
        e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS
        \right)\\
        &=&
        2\pi\,\mathcal{F}^{-1}
        \Bigl(
        |S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)
        \Bigr)
        \bigl(x\cos\theta + y\sin\theta,\theta\bigr)\\
    \end{array}
\]


Autrement dit, l'int√©grale int√©rieure de l'√©quation (7.4) est √©gale √† $2\pi$ fois l'inverse de la transform√©e de Fourier de
$|S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)$
au point $(x\cos\theta + y\sin\theta,\theta)$.
Nous pouvons alors voir que l'√©quation (7.4) est en fait √©gale √†
\[
\frac{1}{2\pi} \int_{0}^{\pi}
\mathcal{F}^{-1}
\Bigl(
|S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)
\Bigr)
\bigl(x\cos\theta + y\sin\theta,\theta\bigr)
\,d\theta.
\]

Finalement, nous constatons que l'int√©grale ci-dessus est √©gale √† $\tfrac{1}{2}$ de la r√©troprojection donn√©e dans la d√©finition \eqref{eq:FBP} pour
$\mathcal{F}^{-1}\bigl[|S|\,\mathcal{F}(\mathcal{R}f)(S,\theta)\bigr]$.
Nous simplifions donc l'√©quation pr√©c√©dente pour obtenir
\[
\frac{1}{2}\,
\mathcal{B}
\Bigl\{
\mathcal{F}^{-1}
\bigl[|S|\,\mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\bigr]
\Bigr\}(x,y).
\]

Ce qui nous conduit √† la conclusion souhait√©e :
\[
f(x,y)
=
\frac{1}{2}\,
\mathcal{B}
\Bigl\{
\mathcal{F}^{-1}
\bigl[|S|\,\mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\bigr]
\Bigr\}(x,y).
\]
\hfill $\square$\\
Le facteur important dans cette formule est le multiplicateur $|S|$ qui appara√Æt entre la transform√©e de Fourier et son inverse. Sans ce facteur, ces deux termes s'annuleraient mutuellement et nous nous retrouverions avec la formule standard de r√©troprojection pour la transform√©e de Radon que nous avons rencontr√©e pr√©c√©demment et qui, comme nous l'avons vu, ne nous donne pas directement $f(x, y)$. Nous appelons ce $|S|$ suppl√©mentaire un \textbf{filtre} de la transform√©e de Radon, ce qui nous donne le nom de la formule de \textbf{r√©troprojection filtr√©e}.
\begin{proposition}
    Soit $f$ et $g$ deux fonctions int√©grables d√©finies sur $\mathbb{R}$, alors
    \[(\mathcal{B}g\star f)(X, Y) = \mathcal{B}(g\star \mathcal{R}f)(X, Y)\]
\end{proposition}
Consid√©rons maintenant la relation \eqref{eq:FBP_filter} et 
supposons qu'il existe une fonction, not√©e $\varphi(t)$, dont la transform√©e de Fourier
soit √©gale √† notre facteur de filtrage $|S|$. Autrement dit, supposons qu'il existe une
fonction $\varphi(t)$ telle que
\[
\mathcal{F}\varphi(S) = |S|.
\]
Plus simplement, supposons que nous connaissions une fonction dont la transform√©e de
Fourier est √©gale √† la fonction valeur absolue. Nous pourrions alors r√©√©crire la
r√©troprojection sous la forme suivante :
\begin{equation}
    f(x,y) = \frac{1}{2}\,\mathcal{B}
    \left\{
    \mathcal{F}^{-1}
    \bigl[
    \mathcal{F}\varphi \cdot \mathcal{F}(\mathcal{R}f)(S,\theta)
    \bigr]
    \right\}(x,y).
    \label{eq:FBP_varphi}
\end{equation}

Cependant, le membre de droite de l'√©quation \eqref{eq:FBP_varphi} contient un produit de transform√©esde Fourier, que nous savons √™tre √©gal √† la convolution des fonctions transform√©es
\[
    f(x,y)
    =
    \frac{1}{2}\,\mathcal{B}
    \left\{
    \mathcal{F}^{-1}
    \bigl[
    \mathcal{F}(\varphi \star \mathcal{R}f)(S,\theta)
    \bigr]
    \right\}(x,y).
\]

Mais ceci n'est rien d'autre que la transform√©e de Fourier inverse de la transform√©e
de Fourier, ce qui nous ram√®ne √† la fonction de d√©part. Cela nous conduit √† la formule
de r√©troprojection filtr√©e beaucoup plus simple :
\begin{equation}
    f(x,y) = \frac{1}{2}\,\mathcal{B}(\varphi \star \mathcal{R}f)(x,y).
    % 
    \label{eq:FBP_varphi_simple}
\end{equation}

L'√©quation \eqref{eq:FBP_varphi_simple} est bien plus √©l√©gante que notre formule initiale de r√©troprojection filtr√©e et ne semble pas difficile √† appliquer. Physiquement parlant, $\mathcal{R}f$ repr√©sente nos donn√©es mesur√©es et l'√©quation \eqref{eq:FBP_varphi_simple} requiert simplement de les filtrer √† l'aide de notre nouvelle fonction $\varphi$, puis d'appliquer la formule de r√©troprojection, qui est une int√©grale relativement simple.

Malheureusement, il n'existe pas de fonction $\varphi$ dont la transform√©e de Fourier
soit exactement √©gale √† la valeur absolue. Consid√©rons la fonction $\mathcal{F}\varphi$ :
\[
\mathcal{F}\varphi(\omega)
=
\int_{-\infty}^{\infty}
\varphi(x)\,e^{-i\omega x}\,dx.
\]

Nous pouvons constater que, lorsque $\omega \to \infty$,
$\mathcal{F}\varphi(\omega) \to 0$ (remarquons l'exponentielle n√©gative).
Cependant, pour la fonction valeur absolue $|\omega|$, lorsque $\omega \to \infty$,
$|\omega| \to \infty$.
Par cons√©quent, il est impossible de trouver une fonction $\varphi$ telle que,
pour tout $\omega$, $\mathcal{F}\varphi(\omega) = |\omega|$.

Toutefois, tout notre travail pr√©c√©dent n'est pas vain. Examinons plut√¥t le type de
fonctions sur lesquelles nous avons restreint notre √©tude. Nous ne consid√©rons notre
fonction que sur un intervalle fini et supposons en fait qu'elle soit nulle en dehors
de cet intervalle. En √©tendant cette id√©e √† la transform√©e de Fourier, nous constatons
que nous devons porter notre attention sur les \emph{fonctions √† bande limit√©e}.

\begin{definition}
    Une fonction $\varphi$ est dite \emph{√† bande limit√©e} s'il existe un r√©el $L > 0$ tel que
    \begin{equation}
        \mathcal{F}\varphi(\omega)
        =
        \int_{-\infty}^{\infty}
        \varphi(x)\,e^{-i\omega x}\,dx
        =
        0
        \quad \text{pour tout } \omega \notin [-L, L].
        % 
        \label{eq:FBP_varphi_banded}
    \end{equation}
\end{definition}

Le facteur de filtrage $|S|$ sert √† amplifier le terme $\mathcal{F}(\mathcal{R}f)$ dans la formule de r√©troprojection filtr√©e originale \eqref{eq:FBP_filter}. En pratique, $\mathcal{F}(\mathcal{R}f)$ est tr√®s sensible aux hautes fr√©quences.

En concentrant notre attention sur les basses fr√©quences √† l'aide d'une fonction √† bande limit√©e $\varphi$, nous sommes en mesure d'√©viter ce probl√®me. Notre objectif est de remplacer $S$ par ce que l'on appelle un \emph{filtre passe-bas} (not√© $S'$), qui prend en compte les effets des basses fr√©quences tout en att√©nuant les hautes fr√©quences. Cette fonction $S'$ doit avoir un support compact et √™tre de la forme
\[
S' = \mathcal{F}\varphi
\]
(sur un intervalle compact).

Le co√ªt de l'utilisation de $S'(\omega)$ est que nous ne disposons plus de l'√©galit√© pr√©sent√©e dans l'√©quation \eqref{eq:FBP_varphi_simple}. En revanche, nous obtenons :
\begin{equation}
    f(x,y) \approx \frac{1}{2}\,\mathcal{B}\!\left(\mathcal{F}^{-1} S' \star \mathcal{R}f \right)(x,y).
    \label{eq:FBP_varphi_approx}
\end{equation}

De mani√®re g√©n√©rale, la plupart des filtres passe-bas sont de la forme
\[
S'(\omega) = |\omega| \cdot F(\omega) \cdot \Pi_L(\omega),
\]
o√π $L > 0$ d√©finit la r√©gion sur laquelle le filtrage est effectu√©. Diff√©rentes fonctions $F$ d√©terminent les caract√©ristiques pr√©cises du filtre, et $\Pi_L(\omega)$ est d√©finie comme suit :
\[
    \Pi_L(\omega) =
    \begin{cases}
        1 & \text{si } |\omega| \leq L, \\
        0 & \text{si } |\omega| > L.
    \end{cases}
\]

Nous introduisons maintenant deux filtres couramment utilis√©s en imagerie num√©rique et en traitement du signal : le filtre \emph{Ram-Lak} et le filtre \emph{Hann}.

\subsection*{Filtre Ram-Lak}

Le filtre Ram-Lak est d√©fini par :
\[
S'(\omega) = |\omega| \cdot \Pi_L(\omega) =
\begin{cases}
|\omega| & \text{si } |\omega| \leq L, \\
0 & \text{si } |\omega| > L.
\end{cases}
\]

Le filtre Ram-Lak constitue la base de nombreux autres filtres utilis√©s en analyse du signal, car il remplace simplement la fonction $F(\omega)$ par la fonction constante √©gale √† 1. D'autres filtres, tels que le filtre Hann, consistent g√©n√©ralement en des produits de fonctions sinus ou cosinus destin√©es √† √©liminer le bruit ind√©sirable.

\subsection*{Filtre Hann}

Le filtre Hann est donn√© par :
\[
S'(\omega) = |\omega| \cdot \frac{1}{2}
\left( 1 + \cos\!\left( \frac{2\pi \omega}{L} \right) \right)
\cdot \Pi_L(\omega).
\]

Le filtre Hann utilise la fonction de Hann
\[
\frac{1}{2}\left( 1 + \cos\!\left( \frac{2\pi \omega}{L} \right) \right)
\]
comme fonction $F(\omega)$,
% et son efficacit√© est illustr√©e dans le sinogramme et la r√©troprojection de la transform√©e de Radon de Johann, pr√©sent√©s √† la Figure~5.
% ====== TODO ======
% Python implementation
% ==================

\section{Discr√©tisation des m√©thodes analytiques}
Ainsi nous avons trait√© presque exclusivement des int√©grales continues pour la transform√©e de Radon, la transform√©e de Fourier et les formules de r√©troprojection. En pratique, cependant, nous n'avons qu'un ensemble fini de donn√©es avec lesquelles travailler. Par cons√©quent, nous devrons former des versions discr√®tes de toutes les formules que nous avons utilis√©es dans notre r√©troprojection filtr√©e.

Une fonction discr√®te est une fonction d√©finie uniquement sur un ensemble d√©nombrable. Pour nos besoins, nous consid√©rerons des fonctions discr√®tes d√©finies sur des ensembles finis (l'ensemble √©tant compos√© des lignes sur lesquelles nous avons pris nos mesures d'intensit√©). Soit \(g_n\) la fonction discr√®te \(g\) √† la valeur \(n\). Comme nous connaissons cette fonction discr√®te sur un ensemble fini, soit \(N\), nous pouvons dire que \(g = g_n : 0 \le n \le N - 1\). Si nous voulons √©tendre cette d√©finition √† tous les entiers, nous pouvons simplement ¬´ r√©p√©ter ¬ª notre fonction encore et encore ; c'est-√†-dire, nous pouvons la rendre p√©riodique avec une p√©riode \(N\). Cette extension sera utile pour certaines des formules discr√®tes que nous rencontrerons.

Supposons que nous prenions des mesures √† \(P\) angles diff√©rents \(\theta\) et que pour chaque angle nous ayons \(2M + 1\) faisceaux espac√©s d'une distance \(d\). Alors nous pouvons d√©finir des valeurs particuli√®res \(\theta_k\) et \(t_j\) comme

\[
\theta_k = \left\{ \frac{k \pi}{P} : 0 \le k \le P - 1 \right\},
\]

\[
t_j = \{ jd : -M \le j \le M \}.
\]

Ce qui nous permet de d√©finir une ligne particuli√®re comme \(l_{t_j, \theta_k}\). Nous d√©finissons donc la transform√©e de Radon discr√®te comme suit :

\begin{definition}
Pour une fonction absolument int√©grable \(f\) et \(0 \le k \le P\) et \(-M \le j \le M\), \((P, M > 0)\), nous d√©finissons la transform√©e de Radon discr√®te de \(f\), not√©e \(\mathcal{R}_D f\), comme

\[
\mathcal{R}_D f_{j,k} = \mathcal{R} f(t_j, \theta_k).
\]

\end{definition}
Pour mettre en ≈ìuvre la formule de r√©troprojection filtr√©e \eqref{eq:FBP_varphi_approx}, nous devons √©galement d√©finir la convolution de deux fonctions discr√®tes.

\begin{definition}
Pour deux fonctions discr√®tes \(N\)-p√©riodiques \(f\) et \(g\), nous d√©finissons la \textbf{convolution discr√®te} de \(f\) et \(g\), not√©e \(f \star g\), comme

\[
(f \star g)_m = \sum_{j=0}^{N-1} f_j \cdot g_{(m-j)}, \quad \text{pour } m \in \mathbb{Z}.
\]
√âvidemment, nous aurons √©galement besoin de la transform√©e de Fourier discr√®te.
\end{definition}

\begin{definition}[Transform√©e de Fourier discr√®te]
√âtant donn√©e une fonction discr√®te $N$-p√©riodique $f$, nous d√©finissons la \textbf{transform√©e de Fourier discr√®te} de $f$, not√©e $\mathcal{F}_D f$, par
\begin{equation}
(\mathcal{F}_D f)_j = \sum_{k=0}^{N-1} f_k e^{i 2 \pi k j / N}, \quad \text{pour } j = 0, 1, \dots, (N-1).
\end{equation}
Il convient de noter que la $N$-p√©riodicit√© de $f$ nous permet de remplacer les bornes de la sommation par tout ensemble d'entiers de longueur $(N-1)$. Avec cette d√©finition, il n'est pas surprenant que nous d√©finissions la transform√©e de Fourier discr√®te inverse de la mani√®re suivante.
\end{definition}

\begin{definition}[Transform√©e de Fourier discr√®te inverse]
√âtant donn√©e une fonction discr√®te $N$-p√©riodique $g$, la \textbf{transform√©e de Fourier discr√®te inverse} de $g$, not√©e $\mathcal{F}_D^{-1} g$, est d√©finie par
\begin{equation}
(\mathcal{F}_D^{-1} g)_n = \frac{1}{N} \sum_{k=0}^{N-1} g_k e^{i 2 \pi k n / N}, \quad \text{pour } n = 0, 1, \dots, (N-1).
\end{equation}
\end{definition}

Nous remarquons que plusieurs des m√™mes propri√©t√©s de la transform√©e de Fourier que nous avons d√©finies dans le cadre continu s'appliquent √©galement au cas discret avec de l√©g√®res modifications :

\begin{proposition}[Propri√©t√©s des fonctions discr√®tes $N$-p√©riodiques]
Pour des fonctions discr√®tes $N$-p√©riodiques $f$ et $g$ :
\begin{enumerate}
    \item $\mathcal{F}_D(f \star g) = (\mathcal{F}_D f) \cdot (\mathcal{F}_D g)$
    \item $\mathcal{F}_D(f \cdot g) = \frac{1}{N} (\mathcal{F}_D f) \star (\mathcal{F}_D g)$
    \item $\mathcal{F}_D^{-1}(\mathcal{F}_D f)_n = f_n \quad \text{pour tout } n \in \mathbb{Z}$
\end{enumerate}
\end{proposition}

Nous sommes maintenant pr√™ts √† aborder la discr√©tisation de la formule de r√©troprojection elle-m√™me. Rappelons que la formule de r√©troprojection √©tait d√©finie comme une int√©grale de $0$ √† $\pi$ par rapport √† $d\theta$. Dans le cas discret, nous avons remplac√© ce $d\theta$ continu par $k\pi / P$ pour $0 \le k \le (P-1)$. Cela conduit √† la d√©finition suivante de la \textbf{r√©troprojection discr√®te} :

\begin{definition}[R√©troprojection discr√®te]
√âtant donn√©e une fonction discr√®te $h$, nous d√©finissons la \textbf{r√©troprojection discr√®te} de $h$, not√©e $\mathcal{B}_D h$, par
\begin{equation}
\mathcal{B}_D h(x,y) = \frac{1}{N} \sum_{k=0}^{N-1} h \big(x \cos \frac{k \pi}{N} + y \sin \frac{k \pi}{N}, k \pi / N \big).
\label{eq:discrete_backprojection}
\end{equation}
\end{definition}

Rappelons notre forme finale pour la formule filtr√©e de r√©troprojection en √©quation \eqref{eq:FBP_varphi_approx} :
$$
f(x,y) \approx \frac{1}{2} \mathcal{B} (\mathcal{F}^{-1} S' \star \mathcal{R} f)(x,y).
$$

Pour former la version discr√®te de cette √©quation, nous voyons que nous devons appliquer la formule suivante:
\begin{equation}
f(x,y) \approx \frac{1}{2} \mathcal{B}_D \left( \mathcal{F}_D^{-1} \mathcal{S}' \ast \mathcal{R}_D f \right)(x,y).
\end{equation}

Nous rencontrons maintenant un l√©ger probl√®me. $\mathcal{R}_D f$ repr√©sente les donn√©es mesur√©es bas√©es sur les intensit√©s finales d'un seul faisceau de rayons X. Nous avons d√©fini les emplacements des diff√©rents faisceaux (et donc des diff√©rentes coupes) en utilisant un syst√®me de coordonn√©es perpendiculaire aux coordonn√©es polaires bas√© sur des angles discrets $\theta$ et des distances $t$.  

En examinant l'√©quation \eqref{eq:discrete_backprojection}, nous voyons que nous devons sommer sur $h$ en diff√©rents points $(x,y)$ dans le syst√®me de coordonn√©es cart√©sien pour cr√©er une grille de niveaux de gris rectangulaire qui repr√©sente notre objet original. Les syst√®mes de coordonn√©es polaires et cart√©siens ne correspondent pas n√©cessairement parfaitement, et nous devons donc \emph{interpoler} les points de donn√©es manquants. L'interpolation consiste √† cr√©er une fonction continue (ou au minimum par morceaux continues) √† partir d'un ensemble discret de valeurs. Il existe de nombreuses m√©thodes pour interpoler une fonction (spline cubique, Lagrange, etc.), chacune ayant ses avantages et inconv√©nients.  

Pour nos besoins, nous allons d√©finir un type g√©n√©ral d'interpolation bas√© sur une fonction de pond√©ration $W$ qui d√©termine comment nous allons choisir nos points interpol√©s. Nous ne d√©finissons pas de fonction de pond√©ration particuli√®re $W$, car les d√©tails de l'interpolation ne sont pas aussi importants que le fait que nous pouvons remplir les "trous" dans nos donn√©es.

\begin{definition}
Pour une fonction de pond√©ration donn√©e $W$ et une fonction discr√®te $N$-p√©riodique $g$, l'\emph{interpolation $W$} de $g$ est d√©finie par :
\begin{equation}
\mathcal{I}_W(g)(x) = \sum_n g(n) \cdot W\left(\frac{x}{d}-n\right), \quad \text{pour } -\infty < x < \infty.
\end{equation}
\end{definition}

Maintenant que nous avons couvert toutes les parties de l'√©quation \eqref{eq:FBP_varphi_simple} dans un cadre discret et trait√© le probl√®me de l'interpolation, nous pouvons proposer un algorithme de reconstruction discret pour r√©soudre le coefficient d'att√©nuation √† partir d'un ensemble de donn√©es discret.  

Nous interpolons ici la fonction $\left(\mathcal{F}_D^{-1}\mathcal{S}'\right) \ast \mathcal{R}_D f(jd,k\pi/N)$ (c'est-√†-dire que nous remplissons les trous apr√®s le filtrage de la transform√©e de Radon). D√©finissons cette fonction interpol√©e comme $\mathcal{I}$. Cela conduit √† la formule de reconstruction suivante :

\begin{equation}
\begin{aligned}
f(x_m,y_n) &\approx \frac{1}{2} \mathcal{B}_D \left( \left( \mathcal{F}_D^{-1}\mathcal{S}' \right) \ast \mathcal{R}_D f \right) (jd, k\pi/N) \\
&\approx \frac{1}{2} \mathcal{B}_D \mathcal{I}(x_m,y_n) \\
&= \frac{1}{2N} \sum_{k=0}^{N-1} \mathcal{I} \left( x_m \cos \frac{k\pi}{N} + y_n \sin \frac{k\pi}{N}, \frac{k\pi}{N} \right).
\end{aligned}
\end{equation}

L'√©quation pr√©c√©dente tient compte de la nature discr√®te de nos donn√©es r√©elles et traite les probl√®mes (comme le manque de donn√©es) qui surviennent lorsque l'on dispose d'un nombre fini de mesures.


% \section{Formulation lin√©aire -- Synth√®se}
% D'accord, nous allons expliquer pas √† pas comment passer de la formulation int√©grale continue de la r√©troprojection filtr√©e √† la \textbf{formulation lin√©aire discr√®te \(g = Af\)} utilis√©e en pratique en tomographie.
% \subsection{R√©troprojection filtr√©e continue}
% On a la formule continue pour la reconstruction filtr√©e :
% \[
% f(x,y) = \frac{1}{2} \int_0^\pi \Big( (\mathcal{F}^{-1} S') \star \mathcal{R} f \Big)(x\cos\theta + y\sin\theta, \theta) \, d\theta
% \]

% Ici :
% \begin{itemize}
%     \item $f(x,y)$ : coefficient d'att√©nuation √† reconstruire,
%     \item $\mathcal{R} f(t,\theta)$ : transform√©e de Radon (projection √† l'angle $\theta$),
%     \item $\mathcal{F}^{-1} S'$ : filtre appliqu√© sur chaque projection,
%     \item $\star$ : convolution dans $t$.
% \end{itemize}

% C'est une \textbf{formule int√©grale continue}, d√©pendante de coordonn√©es polaires.\vspace{5pt}\\
% Cette expression met en √©vidence la structure math√©matique exacte de la reconstruction tomographique id√©ale. Toutefois, elle repose sur des int√©grales et des fonctions continues qui ne peuvent pas √™tre manipul√©es directement en pratique. Pour une impl√©mentation num√©rique, il est indispensable de passer √† une repr√©sentation discr√®te. Cette transition constitue le c≈ìur des m√©thodes de reconstruction utilis√©es en imagerie m√©dicale.

% \subsection{Discr√©tisation des coordonn√©es et des angles}

% Pour passer au discret :
% \begin{enumerate}
%     \item On ne mesure que $P$ angles : $\theta_k = k\pi/P$, $k = 0,\dots,P-1$,
%     \item On ne mesure que $2M+1$ faisceaux par angle, espac√©s de $d$ : $t_j = j d, j=-M,\dots,M$,
%     \item On obtient donc la \textbf{transform√©e de Radon discr√®te} :
%     \[
%     \mathcal{R}_D f_{j,k} = \mathcal{R} f(t_j, \theta_k).
%     \]
% \end{enumerate}\vspace{5pt}
% Cette √©tape traduit les contraintes physiques des syst√®mes d'acquisition r√©els, qui ne fournissent qu'un nombre fini de mesures. L'√©chantillonnage en angle et en position transforme ainsi le probl√®me continu en un ensemble de donn√©es num√©riques exploitables. La qualit√© de la reconstruction d√©pend directement de la finesse de cette discr√©tisation. Elle conditionne notamment la r√©solution spatiale et les artefacts.

% \subsection{Convolution et filtrage discrets}

% On applique ensuite le filtre sur chaque projection :
% \[
% h_{j,k} = (\mathcal{F}_D^{-1} \mathcal{S}' \ast \mathcal{R}_D f)_{j,k}
% \]

% Ici, $\ast$ est la \textbf{convolution discr√®te} dans $t$ :
% \[
% (f \ast g)_m = \sum_{n=0}^{N-1} f_n \, g_{(m-n)}.
% \]\vspace{5pt}
% Le filtrage est une √©tape cruciale de la m√©thode FBP, car il corrige le flou introduit par la r√©troprojection simple. La convolution discr√®te permet d'impl√©menter efficacement ce filtrage sur des donn√©es √©chantillonn√©es. Elle renforce les hautes fr√©quences n√©cessaires √† une bonne r√©solution spatiale. Sans cette √©tape, la reconstruction serait fortement d√©grad√©e.

% \subsection{Discr√©tisation de la r√©troprojection}

% La r√©troprojection discr√®te est :
% \[
% f(x_m,y_n) \approx \frac{1}{2N} \sum_{k=0}^{N-1} h\Big( x_m \cos \frac{k\pi}{N} + y_n \sin \frac{k\pi}{N}, \frac{k\pi}{N} \Big).
% \]

% Comme les coordonn√©es cart√©siennes $(x_m, y_n)$ ne tombent pas exactement sur les positions $t_j$, on \textbf{interpole} :
% \[
% h\big(x_m\cos\theta_k + y_n \sin\theta_k, \theta_k\big) \approx \sum_j h_{j,k} \, W\left(\frac{x_m \cos\theta_k + y_n \sin\theta_k - t_j}{d}\right),
% \]
% o√π $W$ est la fonction de pond√©ration de l'interpolation (lin√©aire, spline, etc.).  
% Cela transforme chaque $f(x_m, y_n)$ en \textbf{combinaison lin√©aire des mesures $h_{j,k}$}.\vspace{5pt}\\
% La r√©troprojection redistribue l'information des projections filtr√©es sur la grille de l'image reconstruite. Cette √©tape assure la coh√©rence g√©om√©trique entre les donn√©es mesur√©es et l'espace image. L'interpolation est indispensable pour relier les coordonn√©es polaires aux pixels cart√©siens. Elle introduit √©galement une approximation contr√¥l√©e du mod√®le continu.


% \subsection{Passage √† la forme matricielle lin√©aire}

% Si on note :
% \begin{itemize}
%     \item $f$ le vecteur de tous les $f(x_m, y_n)$ sur la grille,
%     \item $g$ le vecteur de toutes les mesures projet√©es filtr√©es $h_{j,k}$,
%     \item $A$ la matrice repr√©sentant la \textbf{r√©troprojection + interpolation},
% \end{itemize}

% alors :
% \[
% f_i = \sum_j A_{ij} \, g_j
% \]

% Chaque coefficient $A_{ij}$ repr√©sente le poids avec lequel la projection $g_j$ contribue au pixel $f_i$.  

% On obtient donc :
% \[
% \boxed{g = Af} \quad \text{ou souvent } f = A g \text{ selon la notation.}
% \]

% En pratique, $A$ est \textbf{tr√®s grande et creuse}, mais la reconstruction se r√©duit √† un simple \textbf{produit matriciel}.\vspace{5pt}\\
% Cette √©criture matricielle unifie l'ensemble du processus de reconstruction dans un cadre lin√©aire. Elle permet d'analyser la FBP avec les outils de l'alg√®bre lin√©aire et de l'optimisation. De nombreuses m√©thodes it√©ratives modernes reposent sur cette formulation. Elle constitue ainsi un pont entre les approches analytiques et num√©riques.

% \subsection{Synth√®se}

% Le passage de l'int√©grale continue √† $g = Af$ se fait en quatre √©tapes principales :
% \begin{enumerate}
%     \item \textbf{√âchantillonnage discret} des angles et des faisceaux ‚Üí $\mathcal{R}_D f$,
%     \item \textbf{Filtrage discret} via convolution et transform√©e de Fourier discr√®te,
%     \item \textbf{R√©troprojection discr√®te} et interpolation sur la grille cart√©sienne,
%     \item \textbf{√âcriture lin√©aire} : chaque pixel reconstruit est une combinaison lin√©aire des mesures ‚Üí matrice $A$.
% \end{enumerate}

% Ainsi, \textbf{toute la formule int√©grale est transform√©e en somme discr√®te}, et la lin√©arit√© de la convolution et de la r√©troprojection permet de la repr√©senter par $A$.\vspace{5pt}\\
% Cette synth√®se met en √©vidence la coh√©rence du passage du mod√®le physique continu vers une impl√©mentation num√©rique concr√®te. La m√©thode FBP appara√Æt alors comme une succession d'op√©rations lin√©aires bien structur√©es. Cette vision est essentielle pour comprendre ses limites et ses extensions. Elle pr√©pare naturellement l'introduction de m√©thodes de reconstruction plus avanc√©es.
\section{Formulation lin√©aire -- Synth√®se}

Ce chapitre explique pas √† pas comment passer de la formulation int√©grale continue de la r√©troprojection filtr√©e √† la \textbf{formulation lin√©aire discr√®te \( g = Af \)} utilis√©e en pratique en tomographie. Cette transition est essentielle pour relier la th√©orie math√©matique aux algorithmes num√©riques impl√©ment√©s dans les syst√®mes r√©els. Elle constitue √©galement le point d‚Äôentr√©e vers les m√©thodes it√©ratives modernes.\vspace{7pt}\\
D'accord, nous allons expliquer pas √† pas comment passer de la formulation int√©grale continue de la r√©troprojection filtr√©e √† la \textbf{formulation lin√©aire discr√®te \(g = Af\)} utilis√©e en pratique en tomographie.

\subsection{R√©troprojection filtr√©e continue}
Cette section pr√©sente l‚Äôexpression analytique id√©ale de la reconstruction tomographique. Elle met en √©vidence le r√¥le central de la transform√©e de Radon, du filtrage et de l‚Äôint√©gration angulaire. Bien que math√©matiquement √©l√©gante, cette formulation reste purement continue et ne peut pas √™tre appliqu√©e directement en pratique.\vspace{7pt}\\
On a la formule continue pour la reconstruction filtr√©e :
\[
f(x,y) = \frac{1}{2} \int_0^\pi \Big( (\mathcal{F}^{-1} S') \star \mathcal{R} f \Big)(x\cos\theta + y\sin\theta, \theta) \, d\theta
\]

Ici :
\begin{itemize}
    \item $f(x,y)$ : coefficient d'att√©nuation √† reconstruire,
    \item $\mathcal{R} f(t,\theta)$ : transform√©e de Radon (projection √† l'angle $\theta$),
    \item $\mathcal{F}^{-1} S'$ : filtre appliqu√© sur chaque projection,
    \item $\star$ : convolution dans $t$.
\end{itemize}

C'est une \textbf{formule int√©grale continue}, d√©pendante de coordonn√©es polaires.
\subsection{Discr√©tisation des coordonn√©es et des angles}
La discr√©tisation permet d‚Äôadapter le mod√®le continu aux contraintes physiques des syst√®mes d‚Äôacquisition. Elle transforme les int√©grales et variables continues en un ensemble fini de mesures exploitables num√©riquement. Cette √©tape conditionne directement la qualit√© et la r√©solution de la reconstruction finale. \vspace{7pt}\\
Pour passer au discret :
\begin{enumerate}
    \item On ne mesure que $P$ angles : $\theta_k = k\pi/P$, $k = 0,\dots,P-1$,
    \item On ne mesure que $2M+1$ faisceaux par angle, espac√©s de $d$ : $t_j = j d, j=-M,\dots,M$,
    \item On obtient donc la \textbf{transform√©e de Radon discr√®te} :
    \[
    \mathcal{R}_D f_{j,k} = \mathcal{R} f(t_j, \theta_k).
    \]
\end{enumerate}

\subsection{Convolution et filtrage discrets}
Le filtrage est une √©tape cruciale de la m√©thode FBP, car il compense le flou introduit par la r√©troprojection simple. Il repose sur l‚Äôop√©ration de convolution, qui permet de renforcer les hautes fr√©quences n√©cessaires √† une bonne r√©solution spatiale. Sans ce filtrage, la reconstruction serait fortement d√©grad√©e.\vspace{7pt}\\
On applique ensuite le filtre sur chaque projection :
\[
h_{j,k} = (\mathcal{F}_D^{-1} \mathcal{S}' \ast \mathcal{R}_D f)_{j,k}
\]

Ici, $\ast$ est la \textbf{convolution discr√®te} dans $t$ :
\[
(f \ast g)_m = \sum_{n=0}^{N-1} f_n \, g_{(m-n)}.
\]

\subsection{Discr√©tisation de la r√©troprojection}

La r√©troprojection assure la redistribution des projections filtr√©es sur la grille de l‚Äôimage reconstruite. Elle garantit la coh√©rence g√©om√©trique entre l‚Äôespace des mesures et l‚Äôespace image. Cette √©tape n√©cessite une interpolation, introduisant une approximation contr√¥l√©e du mod√®le continu.\vspace{7pt}\\
La r√©troprojection discr√®te est :
\[
f(x_m,y_n) \approx \frac{1}{2N} \sum_{k=0}^{N-1} h\Big( x_m \cos \frac{k\pi}{N} + y_n \sin \frac{k\pi}{N}, \frac{k\pi}{N} \Big).
\]
Comme les coordonn√©es cart√©siennes $(x_m, y_n)$ ne tombent pas exactement sur les positions $t_j$, on \textbf{interpole} :
\[
h\big(x_m\cos\theta_k + y_n \sin\theta_k, \theta_k\big) \approx \sum_j h_{j,k} \, W\left(\frac{x_m \cos\theta_k + y_n \sin\theta_k - t_j}{d}\right),
\]
o√π $W$ est la fonction de pond√©ration de l'interpolation (lin√©aire, spline, etc.).\vspace{7pt}\\
Cela transforme chaque $f(x_m, y_n)$ en \textbf{combinaison lin√©aire des mesures $h_{j,k}$}.
\subsection{Passage √† la forme matricielle lin√©aire}
La formulation matricielle permet de rassembler toutes les op√©rations pr√©c√©dentes dans un cadre lin√©aire unique. Elle constitue un lien direct entre la th√©orie continue et les algorithmes num√©riques. Cette √©criture est essentielle pour l‚Äôanalyse et l‚Äôextension vers des m√©thodes it√©ratives.\vspace{7pt}\\
Si on note :
\begin{itemize}
    \item $f$ le vecteur de tous les $f(x_m, y_n)$ sur la grille,
    \item $g$ le vecteur de toutes les mesures projet√©es filtr√©es $h_{j,k}$,
    \item $A$ la matrice repr√©sentant la \textbf{r√©troprojection + interpolation},
\end{itemize}

alors :
\[
f_i = \sum_j A_{ij} \, g_j
\]

On obtient :
\[
\boxed{g = Af} \quad \text{(ou } f = Ag \text{ selon la convention)}
\]

En pratique, $A$ est \textbf{tr√®s grande et creuse}, mais la reconstruction se r√©duit √† un produit matriciel.

\begin{definition}[Matrice syst√®me $\Phi$ et poids $\varphi_{i,j}$]
Dans le cadre discret, le vecteur de donn√©es de projection √† faisceau parall√®le $\vec{g}$ est mod√©lis√© par une somme pond√©r√©e sur les pixels travers√©s par le rayon X :
\begin{equation}
g_i = \sum_{j=1}^{N} \varphi_{i,j} \cdot f_j, \quad \text{o√π } i = 1, 2, \cdots, M.
\end{equation}
Le coefficient de pond√©ration $\varphi_{i,j}$ de la matrice syst√®me $\Phi$ est √©gal √† la longueur d'intersection du $i$-√®me rayon √† travers le $j$-√®me pixel.
\end{definition}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/projection √† faisceau parall√®le.png}
    \caption{Calcul du coefficient de poids $\varphi_{i,j}$ de la matrice syst√®me $\Phi$ √† partir de la longueur d'intersection du $i$-√®me rayon √† travers le $j$-√®me pixel.}
    \label{fig:phi}
\end{figure}

Le calcul direct de chaque $\varphi_{i,j}$ est co√ªteux. Pour acc√©l√©rer la reconstruction, on peut pr√©-calculer et stocker ces poids, et exploiter les propri√©t√©s de sym√©trie des projections √† faisceau parall√®le pour r√©duire le nombre de calculs n√©cessaires.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/projection √† faisceau parall√®le-2.png}
    \caption{Mesures des rayons-\textbf{X} $a$, $b$, $c$ et $d$ pour des angles de rotation $\alpha$, $90-\alpha$, $90+\alpha$ et $180-\alpha$. Les propri√©t√©s de sym√©trie permettent de d√©duire les poids d'un rayon √† partir d'un autre.}
    \label{fig:mesure-rayons-X}
\end{figure}


\subsection{Synth√®se}
Cette synth√®se met en √©vidence la coh√©rence globale du passage du mod√®le continu vers une impl√©mentation discr√®te. Elle permet de comprendre la FBP comme une succession structur√©e d‚Äôop√©rations lin√©aires. Cette vision pr√©pare naturellement l‚Äôintroduction de m√©thodes de reconstruction plus avanc√©es.\vspace{7pt}\\
Le passage de l'int√©grale continue √† $g = Af$ se fait en quatre √©tapes principales :
\begin{enumerate}
    \item \textbf{√âchantillonnage discret} des angles et des faisceaux,
    \item \textbf{Filtrage discret} par convolution,
    \item \textbf{R√©troprojection discr√®te} avec interpolation,
    \item \textbf{Formulation lin√©aire matricielle}.
\end{enumerate}

\subsubsection*{Conclusion}
Ce chapitre a pr√©sent√© les principaux outils math√©matiques qui fondent la reconstruction d'images tomographiques, en mettant en √©vidence la transition fondamentale entre les m√©thodes analytiques classiques et les approches modernes bas√©es sur le \textit{Compressed Sensing}.\vspace{7pt}\\
Les m√©thodes analytiques, historiquement les premi√®res, reposent sur une formulation math√©matique √©l√©gante et directe du probl√®me inverse. La transform√©e de Radon en constitue la pierre angulaire, en mod√©lisant le lien entre l'objet et ses projections. Son inversion, fond√©e sur le th√©or√®me de la coupe centrale et mise en ≈ìuvre dans l'algorithme de r√©troprojection filtr√©e (FBP), permet une reconstruction rapide. Ces m√©thodes, dont la FBP demeure un standard clinique, supposent toutefois des donn√©es abondantes, compl√®tes et faiblement bruit√©es.\vspace{7pt}\\
Cependant, les exigences actuelles de r√©duction de dose et de temps d'acquisition conduisent √† des sc√©narios sous-√©chantillonn√©s, dans lesquels les m√©thodes analytiques atteignent leurs limites, se traduisant par des artefacts et une forte sensibilit√© au bruit. C'est dans ce contexte que les m√©thodes it√©ratives et le cadre du \textit{Compressed Sensing} prennent tout leur sens. En formulant la reconstruction comme un probl√®me inverse r√©gularis√©, elles exploitent des connaissances a priori sur l'image, telles que sa parcimonie dans un domaine appropri√© (ondelettes, gradient), afin de stabiliser l'inversion et d'obtenir des reconstructions de qualit√© √† partir de donn√©es limit√©es. La variation totale (TV) constitue un exemple de r√©gularisation particuli√®rement adapt√©, permettant de pr√©server les contours tout en r√©duisant le bruit.\vspace{7pt}\\
La transform√©e de Fourier et l'op√©ration de convolution jouent un r√¥le transversal essentiel, aussi bien dans l'impl√©mentation du filtrage pour la FBP que dans l'analyse fr√©quentielle des donn√©es. Par ailleurs, la discr√©tisation des op√©rateurs math√©matiques et la formulation matricielle lin√©aire du probl√®me, sous la forme
\[
g = H f,
\]
permettent d'√©tablir un lien direct entre la th√©orie continue et son impl√©mentation num√©rique, ouvrant ainsi la voie aux algorithmes d'optimisation it√©ratifs.\vspace{7pt}\\
En r√©sum√©, ce chapitre dresse un panorama coh√©rent des approches algorithmiques de la reconstruction tomographique. Il montre que si les m√©thodes analytiques offrent rapidit√© et simplicit√© dans des conditions id√©ales, les m√©thodes it√©ratives r√©gularis√©es, appuy√©es par la th√©orie du \textit{Compressed Sensing}, constituent une r√©ponse incontournable aux d√©fis de l'imagerie moderne : reconstruire davantage d'information √† partir de moins de donn√©es, sans compromettre la qualit√© diagnostique ni la s√©curit√© du patient. La ma√Ætrise de ces outils math√©matiques appara√Æt ainsi comme un levier essentiel pour le d√©veloppement des m√©thodes de reconstruction de demain.
