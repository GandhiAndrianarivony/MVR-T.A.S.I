\chapter{Quelques mod√®les de reconstruction}
\section{Les traitements pr√©alables √† la reconstruction}

\subsection{\Large M√©thodes dans le domaine spatial}
% =================== TODO ==================
\subsubsection{\large Filtrage lin√©aire}
% =========================================


% \subsection{\Large M√©thodes dans le domaine transform√©}
\section{\large Transform√©e de Fourier}
\begin{definition}[Transform√©e de Fourier]
    Soit \( f \) une fonction absolument int√©grable sur \( \mathbb{R} \).
    La transform√©e de Fourier de \( f \), not√©e \( \mathcal{F}f \), est d√©finie
    pour tout nombre r√©el \( \xi \) par
    \[
    (\mathcal{F}f)(\xi)
    = \int_{-\infty}^{\infty} f(x)\, e^{-2\pi i \xi x}\, dx.
    \]
\end{definition}
La transform√©e de Fourier est fr√©quemment utilis√©e en analyse du signal et permet de transformer une fonction du temps en une fonction de la fr√©quence ; la variable $x$ repr√©sente le temps en secondes et la variable \( \xi \) repr√©sente la fr√©quence de la fonction en hertz.\\

Il existe une d√©finition alternative faisant intervenir la fr√©quence angulaire $w=2\pi \xi$, ce qui conduit √† l'expression suivante.
\[(\mathcal{F}f)(w) = \int_{-\infty}^{\infty} f(x)\, e^{-i w x}\, dx\]
Comme pour la transform√©e de Radon, nous allons √©num√©rer plusieurs propri√©t√©s de la transform√©e de Fourier.
\begin{proposition}
    Pour des constantes r√©elles $\alpha$ et $\beta$, et des fonctions absolument int√©grables $f$ et $g$, on a:
    \begin{itemize}
        \item[(i)] Lin√©arit√© : $\mathcal{F}(\alpha f + \beta g)(w) = \alpha \mathcal{F}f(w) + \beta \mathcal{F}g(w)$
        \item[(ii)] $\mathcal{F}f(w) < +\infty$
    \end{itemize}
\end{proposition}

\begin{definition}[Transform√©e de Fourier inverse]
Soit \( f \) une fonction absolument int√©grable.
La transform√©e de Fourier inverse de \( f \), not√©e \( \mathcal{F}^{-1}f \),
√©valu√©e en \( x \), est d√©finie par
\begin{equation}
    (\mathcal{F}^{-1}f)(x)
    = \cfrac{1}{2\pi}\int_{-\infty}^{\infty} f(w)\, e^{iw x}\, dw.
    \label{formula:fourier_inverse}
\end{equation}
\end{definition}
Ceci nous conduit imm√©diatement au th√©or√®me suivant.
\begin{proposition}[Th√©or√®me d'inversion de Fourier]
Soit $f$ une fonction absolument integrale sur $\mathbb{R}$.
Le th√©or√®me d'inversion de Fourier affirme que, pour tout \( x \),
\[
(\mathcal{F}^{-1} \circ \mathcal{F})f(x)=f(x)
\]
\end{proposition}
Jusqu'√† pr√©sent, nous n'avons abord√© la transform√©e de Fourier que dans une dimension. Il existe des d√©finitions correspondantes en dimensions sup√©rieures, mais, pour nos besoins, nous n'utiliserons que les analogues en deux dimensions.

\begin{definition}[Transform√©e de Fourier bidimensionnelle]
Soit \( g \) une fonction absolument int√©grable d√©finie sur \( \mathbb{R}^2 \).
La transform√©e de Fourier bidimensionnelle de \( g \), not√©e \( \mathcal{F}_2 g \),
est d√©finie pour tout \((X,Y) \in \mathbb{R}^2\) par
\begin{equation}
    (\mathcal{F}_2 g)(X,Y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} 
    g(x,y)\, e^{-i (xX + yY)} \, dx\, dy.
    \label{eq:fourier_2d}
\end{equation}

\end{definition}

De mani√®re similaire, nous d√©finissons la transform√©e de Fourier inverse sur $\mathbb{R}^2$.
\begin{definition}[Transform√©e de Fourier bidimensionnelle inverse]
Soit \( g \) une fonction absolument int√©grable d√©finie sur \( \mathbb{R}^2 \).
La transform√©e de Fourier bidimensionnelle inverse de \( g \), √©valu√©e en \((x,y)\)
et not√©e \( \mathcal{F}_2^{-1} g(x,y) \), est donn√©e par
\[
(\mathcal{F}_2^{-1} g)(x,y) = \cfrac{1}{4\pi^2}\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} 
g(X,Y)\, e^{i (xX + yY)} \, dX\, dY.
\]
\end{definition}

% ================== TODO ==================
\subsubsection{\large Filtre de Wiener}
% 1. Filtre de Wiener
% ‚úÖ Oui, tout √† fait applicable
% Le filtre de Wiener est un filtre lin√©aire adaptatif.

% Il peut √™tre appliqu√© :
%    - sur chaque projection (variable s)
%    - ou localement sur le sinogramme

% Int√©r√™t :
%    - r√©duction du bruit additif (souvent gaussien)
%    - compromis bruit / flou optimal au sens MSE

% ‚ö†Ô∏è Limites :
%    - n√©cessite une estimation du bruit et du spectre du signal
%    - un mauvais mod√®le d√©grade la reconstruction

% üìå Tr√®s utilis√© comme pr√©traitement des sinogrammes en CT √† faible dose.

\subsubsection{\large Curvelets}
% 4. Curvelets
% ‚úÖ Oui, tr√®s pertinent
% Les curvelets sont th√©oriquement bien adapt√©es :
%    - excellente repr√©sentation des singularit√©s le long de courbes

% Les lignes du sinogramme correspondent √† :
%    - des courbes li√©es aux bords de l'objet

% üìå Tr√®s utilis√© dans :
%    - CT basse dose
%    - Les m√©thodes variationnelles et it√©ratives
% =================================================

\section{Convolution}
\textbf{D√©finition 8.1.}
Pour deux fonctions int√©grables $f$ et $g$ d√©finies sur $\mathbb{R}$,
nous d√©finissons la convolution de $f$ et $g$, not√©e $f \star g$, par
\[
(f \star g)(x) = \int_{-\infty}^{\infty} f(t)\,g(x - t)\,dt,
\]
o√π $x \in \mathbb{R}$.

Nous pouvons facilement √©tendre cette d√©finition √† l'espace
bidimensionnel. Pour les fonctions polaires, nous prenons uniquement
l'int√©grale par rapport √† la variable radiale, tandis que pour les
fonctions cart√©siennes nous int√©grons par rapport aux deux variables.
Les d√©finitions explicites sont donn√©es ci-dessous.

\begin{definition}
    Pour des fonctions polaires int√©grables $f(t,\theta)$ et $g(t,\theta)$,
    nous d√©finissons la convolution de $f$ et $g$ par
    \[
        (f \star g)(t,\theta)
        =
        \int_{-\infty}^{\infty}
        f(s,\theta)\,g(t - s,\theta)\,ds.
    \]
\end{definition}

Pour des fonctions int√©grables $F$ et $G$ sur $\mathbb{R}^2$,
nous d√©finissons la convolution de $F$ et $G$ par
\[
    (F \star G)(x,y)
    =
    \int_{-\infty}^{\infty}
    \int_{-\infty}^{\infty}
    F(s,t)\,G(x - s, y - t)\,ds\,dt.
\]

La convolution est une m√©thode math√©matique permettant de moyenner
une fonction $f$ √† l'aide du d√©placement d'une autre fonction $g$.
Dans la convolution $f \star g$, la fonction $g$ est translat√©e √† travers
la fonction $f$, et la fonction r√©sultante d√©pend de la zone de recouvrement
au cours de cette translation.
En un certain sens, on peut voir $g$ comme un filtre utilis√© pour effectuer
une moyenne de $f$ sur un intervalle donn√©.
La fonction de filtrage agit ainsi comme un lisseur pour les donn√©es bruit√©es
fournies par la fonction originale.

\begin{proposition}
    Pour des fonctions int√©grables $f$, $g$, $h$ d√©finies sur $\mathbb{R}$
    et des constantes $\alpha, \beta \in \mathbb{R}$ :
    
    \begin{itemize}
      \item[(i)] $f \star g = g \star f$ \quad (commutativit√©),
      \item[(ii)] $f \star (\alpha g + \beta h)
      = \alpha (f \star g) + \beta (f \star h)$ \quad (lin√©arit√©).
      \item[(iii)] $\mathcal{F}(f). \mathcal{F}(g)  = \mathcal{F}(f \star g)$
    \end{itemize}
\end{proposition}


% =================================================
\section{La transform√©e de Radon}
% =================================================
L'hypoth√®se fondamentale est que le d√©tecteur mesure l'att√©nuation int√©gr√©e le long d'un rayon. 
\begin{definition}
    Pour un faisceau de rayons $\mathbf{X}$ d'√©nergie $\mathbf{E}$ donn√©e et un taux de propagation des photons $\mathbf{N}(x)$, l'intensit√© du faisceau $\mathbf{I}(x)$ √† une distance $x$ de l'origine est d√©finie comme \[\mathbf{I}(x) = \mathbf{N}(x) \mathbf{E}\]
\end{definition}

\begin{definition}
    La proportion de photons absorb√©s par millim√®tre de substance √† une distance $x$ de l'origine est appel√©e le coefficient d'att√©nuation $\mathbf{A}(x)$ du milieu.
\end{definition}


Nous connaissons les intensit√©s initiale et finale, $I_0$ et $I_1$ d'un faisceau unique. L'objectif est d'utiliser ces intensit√©s pour d√©terminer le coefficient d'att√©nuation le long du trajet du faisceau. Heureusement, la loi de Beer-Lambert √©tablit une relation entre ces deux grandeurs.

\begin{definition}[Loi de Beer-Lambert]
Pour un faisceau de rayons X monochromatique, non r√©fractif et de largeur nulle,
traversant un milieu homog√®ne sur une distance \(x\) √† partir de l'origine,
l'intensit√© \(I(x)\) est donn√©e par
\begin{equation}
    I(x) = I_0 e^{-\mathbf{A}(x)x}
    \label{eq:loi_beer_lambert}
\end{equation}
\end{definition}
En l'√©tat, cette √©quation ne nous est pas particuli√®rement utile. Elle exprime le coefficient d'att√©nuation en un point donn√© en fonction de l'intensit√© en ce point, alors que nous ne connaissons la valeur de l'intensit√© qu'en des points situ√©s √† l'ext√©rieur de l'objet. Ce que nous cherchons r√©ellement est une relation entre le coefficient d'att√©nuation √† l'int√©rieur de l'objet et la variation de l'intensit√© du faisceau. Pour cela, nous allons manipuler l√©g√®rement l'√©quation \eqref{eq:loi_beer_lambert}.\\
En passant √†  la d√©riv√©e de la loi de Beer-Lambert, nous obtenons la relation suivante :
\[
    \frac{dI}{dx} = -\mathbf{A}(x)I(x)
\]
Soit $I(x_0)=I_0$ la valeur initiale de l'intensit√© du faisceau et $I(x_1)=I_1$ la valeur finale de l'intensit√© du faisceau. En utilisant cette relation, nous obtenons la relation suivante :

\[
    -\int_{x_0}^{x_1} \mathbf{A}(x)dx = \int_{x_0}^{x_1}\cfrac{dI}{I(x)}=ln(\frac{I_1}{I_0})
\]
ou encore \vspace{10pt}
\begin{equation}
    \int_{x_0}^{x_1} \mathbf{A}(x)dx = ln(\frac{I_0}{I_1})
    \label{eq:radon_transformation}
\end{equation}

Nous sommes maintenant pr√™ts √† introduire des outils math√©matiques ‚Äî en particulier la transform√©e de Radon ‚Äî qui joueront un r√¥le central dans la d√©termination du coefficient d'att√©nuation dans l'√©quation \eqref{eq:loi_beer_lambert}.

L'√©criture sous forme normale d'une √©quation de droite joue un r√¥le cl√© dans la transform√©e de Radon, car elle permet une param√©trisation naturelle et compl√®te de toutes les droites du plan, ce qui est essentiel pour la d√©finition math√©matique et le calcul pratique de cette transformation.\\ 
Cette √©quation sous forme normale fournit :
\begin{itemize}
    \item[(i)] Une param√©trisation unique et continue de toutes les droites du plan. La forme normale (ou forme normale de Hesse) de l'√©quation de la droite s'√©crit : $$x\,\cos(\theta)+y\,\sin(\theta)=\rho$$ o√π $\rho$ est la distance par rapport √† l'origine et $\theta$ est l'angle par rapport √† l'axe des abscisses.
    \item[(ii)] Une interpr√©tation g√©om√©trique claire de $\rho$ et $\theta$. Chaque droite du plan correspond  √† un unique couple ($\rho,\theta$). Cette param√©trisation √©vite les redondances et garantit qu'on parcourt toutes les droites une et une seule fois (√† une convention pr√®s).
    \item[(iii)] Une mesure naturelle sur l'espace des droites, utilis√©e dans les formules d'inversion.
    \item[(iv)] Un formalisme adapt√© au th√©or√®me de coupe, reliant transform√©e de Radon et transform√©e de Fourier 2D. 
    \item[(v)] Une mesure naturelle sur l'espace des droites, utilis√©e dans les formules d'inversion.
\end{itemize}\vspace{10pt}
\subsubsection{\small Construction de l'orientation et de la distance}
Nous connaissons tous l'id√©e qu'une droite \( l \) dans \( \mathbb{R}^2 \) peut √™tre repr√©sent√©e par l'√©quation 
\[
ax + by = c
\]
o√π \( a, b, c \in \mathbb{R} \) et \( a^2 + b^2 \neq 0 \).\\ On peut alors √©crire cette √©quation d'une droite sous la forme \[w_1x + w_2y = t\]
o√π $\mathbf{w}:=(w_1, w_2) = (\cfrac{a}{\sqrt{a^2 + b^2}}, \cfrac{b}{\sqrt{a^2 + b^2}})$ et $t=\cfrac{c}{\sqrt{a^2 + b^2}}$, que nous pouvons voir comme un point situ√© sur le
cercle unitaire, pour \[\left(\cfrac{a}{\sqrt{a^2 + b^2}}\right)^{2} + \left(\cfrac{b}{\sqrt{a^2 + b^2}}\right)^{2} = 1\]
Cela implique que $\mathbf{w} := (\cos(\theta), \sin(\theta)) \text{ est un vecteur normal unitaire }$, $\theta \in [0, 2\pi)$ repr√©sente l'orientation, et $t$ est exactement la distance √† l'origine. On a \[x\cos(\theta) + y\sin(\theta) = t\]
Notez que dans les √©quations ci-dessus, $t$ et $\theta$ sont fixes et d√©terminent une droite sp√©cifique \( l \) dans le plan. On peut donc dire que $t$ et $\theta$ param√®trent une droite \( l_{t,\theta} \) et que $\mathbf{z}$ d√©termine des points sp√©cifiques sur cette droite \( l \). Ou encore
\[l_{t,\theta} = \{ \mathbf{z} \in \mathbb{R}^2 : \langle z, (\cos \theta, \sin \theta) \rangle = t \}.\]
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/l_t_theta.png}
    \caption{param√®trisation d'une droite \( l_{t,\theta} \) par \( t \) et \( \theta \)}
    \label{fig:l_t_theta}
\end{figure}
On voit  que $(t\, \cos(\theta), t\, \sin(\theta))$ est un point situ√© sur la droite \( l_{t,\theta} \) (\Cref{fig:l_t_theta}) et $(-\sin(\theta), \cos(\theta))$ est un vecteur perpendiculaire au vecteur unitaire $\mathbf{w}$.\\ En g√©om√©trie affine √©l√©mentaire, une ligne est un point plus une direction. Par cons√©quent, nous pouvons d√©crire un point particulier $(x, y)$ sur $l_{t, \theta}$ en termes de nombre r√©el s comme suit :
\begin{equation}
    l_{t, \theta} = \{(t\, \cos(\theta) - s\,\sin(\theta), t\,\sin(\theta) + s\,\cos(\theta)); s\in \mathbb{R}\}
    \label{set:l_t_theta}
\end{equation}
\begin{definition}[Transform√©e de Radon]
Soit \( f(t,\theta) \) une fonction d√©finie sur \( \mathbb{R}^2 \) √† support compact.
La transform√©e de Radon de \( f \), not√©e \( \mathcal{R}f \), est d√©finie pour
\( t \in \mathbb{R} \) et \( \theta \in (0, 2\pi] \) par
\[
\mathcal{R}f(t,\theta) = \int_{-\infty}^{\infty} f(x(s),y(x))\mathrm{d}s
\]
\end{definition}

La transform√©e de Radon permet de d√©terminer la densit√© totale d'une fonction $f$ le long d'une droite donn√©e $l$. Cette droite $l$ est d√©finie par un angle $\theta$  par rapport √† l'axe 
$x$ et une distance $t$ par rapport √† l'origine. Comme illustr√© √† la \Cref{fig:radon}, si l'on calcule la transform√©e de Radon le long de plusieurs droites √† des angles diff√©rents (ici $\theta_1$ et $\theta_2$), on peut d√©terminer plusieurs fonctions de densit√© pour notre objet. Intuitivement, on peut interpr√©ter la transform√©e de Radon comme une version ¬´ √©tal√©e ¬ª de notre objet initial. Supposons que la r√©gion en forme de tache repr√©sent√©e √† la \Cref{fig:radon} soit une tache d'encre; si l'on √©tale cette tache le long de lignes de direction $\theta_1$, on s'attend √† ce que les r√©gions les plus larges de la tache correspondent √† des zones plus √©tendues que les r√©gions plus petites, ce qui correspond exactement √† ce que l'on observe.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/radon.png}
    \caption{Transform√©e de Radon pour $\theta_1$ et $\theta_2$.}
    \label{fig:radon}
\end{figure}
L'int√©grale $\mathcal{R}f(t,\theta)$ repr√©sente le membre gauche de l'√©quation \eqref{eq:radon_transformation}. Rappelons que, dans cette √©quation, $\mathbf{A}(x)$ est inconnue et que $\ln(\frac{I_1}{I_0})$ correspond √† une information mesur√©e.
Autrement dit, $\ln(\frac{I_1}{I_0})$ est la transform√©e de Radon, et la transform√©e de Radon repr√©sente donc des donn√©es connues issues de la mesure.

L'objectif est maintenant de trouver une formule d'inversion de la transform√©e de Radon qui nous permettra de reconstruire la fonction initiale $f$ (ou, dans le contexte de l'imagerie m√©dicale, 
$\mathbf{A}(x)$). Pour ce faire, il sera utile de rappeler plusieurs propri√©t√©s de la transform√©e de Radon.
\begin{proposition}
    Soit $\alpha$ et $\beta$ deux r√©els et $f$ et $g$ deux fonctions continues sur $\mathbb{R}^2$ √† support compact. On a
    \begin{itemize}
        \item[(i)] Lin√©arit√© : $\mathcal{R}(\alpha f + \beta g) = \alpha \mathcal{R}f + \beta \mathcal{R}g$
        \item[(ii)] Parit√©: $\mathcal{R}f(-t,-\theta) = \mathcal{R}f(t,\theta)$
        \item[(iii)] $\mathcal{R}f(t, \theta) = \int_{-\infty}^{\infty} f(x(s), y(s))\mathrm{d}s = \int_{-\infty}^{\infty} f(t\,cos(\theta)-s\,sin(\theta), t\,sin(\theta)+s\,cos(\theta))\mathrm{d}s$
        % \item[(iv)] Invariance par rotation : \(\mathcal{R}(f \circ R_{\psi}) = \mathcal{R}f(t,\theta - \psi)\)
        % \item[(v)] Relation avec la convolution : \(\mathcal{R}(f * g) = \mathcal{R}f * \mathcal{R}g\)
    \end{itemize}
\end{proposition}
Nous d√©finissons en outre le domaine naturel de la transform√©e de Radon comme l'ensemble des fonctions $f$ sur $\mathbb{R}^2$ telles que \[\int_{-\infty}^{\infty} |f(x(s), y(s))|\mathrm{d}s < \infty\]

\subsection{Le Th√©or√®me de la Coupe Centrale}
Le th√©or√®me de la coupe centrale, √©galement appel√© th√©or√®me de projection-transforme de Fourier ou th√©or√®me de Fourier-Slice, est un r√©sultat fondamental en traitement d'image et en tomographie. Il √©tablit un lien profond entre la transform√©e de Radon (utilis√©e pour d√©crire les projections d'un objet) et la transform√©e de Fourier (utilis√©e pour analyser les fr√©quences spatiales). Ce th√©or√®me constitue la pierre angulaire math√©matique de la plupart des m√©thodes de reconstruction tomographique moderne.

\begin{proposition}
    Soit \( g \) une fonction absolument integrale sur \( \mathbb{R}^2 \).
    Le th√©or√®me de la coupe centrale affirme que, pour tout $S \in \mathbb{R}$ et $\theta \in [0,2\pi]$, on a : \[\mathcal{F}_2 g(S\cos(\theta), S\sin(\theta)) = \mathcal{F}(\mathcal{R}g)(S, \theta)\]
\end{proposition}
\textbf{Preuve}: En utilisant la d√©finition de la transform√©e de Fourier bidimensionnelle \eqref{eq:fourier_2d} on obtient 
\[
    \mathcal{F}_{2}g(S\,\cos(\theta), S\,\sin(\theta)) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y)\, e^{-iS (x\,\cos(\theta) + y\,\sin(\theta))}\, dx\, dy
\]
Nous effectuons maintenant un changement de variables conform√©ment au syst√®me
de coordonn√©es que nous avons d√©fini √† la \textit{Construction de l'orientation et de la distance}.
Rappelons que, lors de la param√©trisation de la droite $\ell_{t,\theta}$,
nous avons montr√© que, pour $s\in\mathbb{R}$, on peut √©crire :
\[
x(s)=t\cos\theta - s\sin\theta, 
\qquad
y(s)=t\sin\theta + s\cos\theta,
\qquad
t = x\cos\theta + y\sin\theta.
\]

En examinant le d√©terminant du Jacobien associ√© √† $x(s)$ et $y(s)$, on obtient :
\[
\det
\begin{pmatrix}
\dfrac{\partial x}{\partial t} & \dfrac{\partial x}{\partial s} \\[6pt]
\dfrac{\partial y}{\partial t} & \dfrac{\partial y}{\partial s}
\end{pmatrix}
= 1.
\]

Nous en d√©duisons que
\[
ds\,dt = dx\,dy.
\]
et donc
\[
\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y)\, e^{-iS (x\,\cos(\theta) + y\,\sin(\theta))}\, dx\, dy = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
g(t\cos\theta - s\sin\theta,\; t\sin\theta + s\cos\theta)\,
e^{-iSt}\,ds\,dt.
\]

Comme $e^{-iSt}$ ne d√©pend pas de la variable $s$, nous pouvons r√©arranger
l'int√©grale pr√©c√©dente de la mani√®re suivante :
\[
\int_{-\infty}^{\infty}
\left(
\int_{-\infty}^{\infty}
g(t\cos\theta - s\sin\theta,\; t\sin\theta + s\cos\theta)\,ds
\right)
e^{-iSt}\,dt.
\]

L'int√©grale int√©rieure est exactement la transform√©e de Radon de $f$,
√©valu√©e en $(t,\theta)$, ce qui implique que l'expression pr√©c√©dente devient :
\[
\int_{-\infty}^{\infty}
(Rg(t,\theta))\,e^{-iSt}\,dt.
\]

Cette derni√®re int√©grale n'est autre que la transform√©e de Fourier de
$Rg(S,\theta)$, ce qui conclut la d√©monstration.
\hfill$\square$

% \section{Inversion analytique de la transform√©e de Radon}
\subsection{R√©troprojection filtr√©e (FBP)}
Nous sommes maintenant enfin pr√™ts √† effectuer une premi√®re tentative pour retrouver la fonction de coefficient d'att√©nuation.
Rappelons que, d'un point de vue physique, la transform√©e de Radon
$\mathcal{R}f(t,\theta)$ nous donne la densit√© totale de l'objet $f$ le long d'une droite
$\ell_{t,\theta}$.
Nous avons d√©termin√© cette densit√© en mesurant les intensit√©s initiale et finale
d'un faisceau de rayons $\mathbf{X}$ traversant l'objet le long de cette droite.
En proc√©dant ainsi pour plusieurs droites diff√©rentes, nous sommes capables de
reconstruire une coupe unique de l'objet initial, et en faisant varier l'angle
$\theta$ de ces rayons $\mathbf{X}$, nous pouvons d√©finir de nombreuses coupes.

Si nous sommes capables, d'une certaine mani√®re, de ¬´ r√©troprojeter ¬ª ces
densit√©s sur le plan, nous pourrons peut-√™tre reconstituer l'objet initial.
Intuitivement, on peut interpr√©ter ce processus comme le fait de prendre les
donn√©es du sinogramme et de les ¬´ d√©flouter ¬ª pour les ramener dans le plan.
\begin{definition}
Soit $h = h(t,\theta)$. On d√©finit la \emph{r√©troprojection},
not√©e $\mathcal{B}h$, en un point $(x,y)$ par :
\[
\mathcal{B}h(x,y) = \frac{1}{\pi}\int_{0}^{\pi} h(x\cos\theta + y\sin\theta,\theta)\,d\theta.
\]

En appliquant cette formule de r√©troprojection √† la transform√©e de Radon, on
obtient :
\begin{equation}
    \mathcal{B}\mathcal{R}f(x,y) = \frac{1}{\pi}\int_{0}^{\pi}
    \mathcal{R}f(x\cos\theta + y\sin\theta,\theta)\,d\theta.
    \label{eq:FBP}
\end{equation}
\end{definition}
Nous sommes capables d'effectuer la r√©troprojection sur les coupes que nous
avons mesur√©es. Comme illustr√© √† la \Cref{fig:FBP}, effectuer une r√©troprojection
selon seulement quelques directions $\theta$ constitue une m√©thode extr√™mement
impr√©cise pour reconstituer ne serait-ce qu'un objet simple. Toutefois, m√™me si
nous augmentons de mani√®re significative le nombre de r√©troprojections
(par exemple jusqu'√† $1000$ directions), il subsiste encore une quantit√©
importante de bruit qui brouille l'image reconstruite.
En r√©alit√©, quel que soit le nombre de directions selon lesquelles nous tentons
d'effectuer la r√©troprojection, nous ne serons jamais capables de reconstruire
parfaitement l'image √† l'aide de la formule de r√©troprojection donn√©e par
l'√©quation \eqref{eq:FBP}.
Pour que ce proc√©d√© soit r√©ellement utile, il est n√©cessaire de d√©river une
m√©thode permettant de filtrer une partie du bruit que la formule de
r√©troprojection semble introduire dans l'image, afin d'obtenir une
repr√©sentation plus lisse de l'objet.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/fbp.png}
    \caption{Retroprojection d'un carr√© dans 5, 25, 100 et 1000 directions}
    \label{fig:FBP}
\end{figure}

Dans ce but, nous d√©finissons une formule de \emph{r√©troprojection filtr√©e}.
\begin{proposition}
    Soit $f$ une fonction absolument int√©grable d√©finie sur $\mathbb{R}^2$. Alors,
    \begin{equation}
        f(x,y)
        =
        \frac{1}{2}\,
        \mathcal{B}\!\left\{
        \mathcal{F}^{-1}
        \!\left[
        |S|\,
        \mathcal{F}\!\left(\mathcal{R}f\right)(S,\theta)
        \right]
        \right\}(x,y).
        \label{eq:FBP_filter}
    \end{equation}
\end{proposition}
\textit{D√©monstration.}
Nous commen√ßons par rappeler que, pour la transform√©e de Fourier bidimensionnelle
et son inverse, on a :
\begin{equation}
f(x,y) = \mathcal{F}_2^{-1}\,\mathcal{F}_2 f(x,y)
= \frac{1}{4\pi^2}
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
\mathcal{F}_2 f(X,Y)\,e^{i(Xx+Yy)}\,dX\,dY.
\label{eq:fourier_2d_inverse}
\end{equation}

Nous allons maintenant effectuer un changement de variables des coordonn√©es
cart√©siennes $(X,Y)$ vers les coordonn√©es polaires $(S,\theta)$, d√©finies par
\[
X = S\cos\theta,
\qquad
Y = S\sin\theta,
\]
o√π $S \in \mathbb{R}$ et $\theta \in [0,\pi]$.
Ce changement de variables conduit au d√©terminant jacobien suivant :
\[\det
\begin{pmatrix}
    \dfrac{\partial X}{\partial s} & \dfrac{\partial X}{\partial \theta} \\[6pt]
    \dfrac{\partial Y}{\partial s} & \dfrac{\partial Y}{\partial \theta}
\end{pmatrix}
=|S|
\]
Ce qui nous dit que $dX\,dY = |S|\,dS\,d\theta$. En incorporant ce nouveau changement de variables, l'√©quation \eqref{eq:fourier_2d_inverse} devient :
\[
f(x,y) = \frac{1}{4\pi^{2}} \int_{0}^{\pi} \int_{-\infty}^{\infty}
\mathcal{F}_{2}f(S\cos\theta, S\sin\theta)\,
e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS\,d\theta.
\]
Et en utilisant le th√©or√®me de la tranche centrale, nous voyons que l'√©quation ci-dessus est en fait √©gale √†
\begin{equation}
    f(x,y) = \frac{1}{4\pi^{2}} \int_{0}^{\pi} \int_{-\infty}^{\infty}
    \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
    e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS\,d\theta.
    \label{eq:fourier_radon}
\end{equation}
Prenons maintenant un regard plus attentif sur l'int√©grale int√©rieure de l'√©quation \eqref{eq:fourier_radon} et en utilisant la d√©finition de la Transform√©e de Fourier inverse, on a :
\[
    \begin{array}{rcl}
        \int_{-\infty}^{\infty}
        \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
        e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS
        &=&
        2\pi \left(
        \frac{1}{2\pi} \int_{-\infty}^{\infty}
        \mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\,
        e^{iS(x\cos\theta + y\sin\theta)}\,|S|\,dS
        \right)\\
        &=&
        2\pi\,\mathcal{F}^{-1}
        \Bigl(
        |S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)
        \Bigr)
        \bigl(x\cos\theta + y\sin\theta,\theta\bigr)\\
    \end{array}
\]


Autrement dit, l'int√©grale int√©rieure de l'√©quation (7.4) est √©gale √† $2\pi$ fois l'inverse de la transform√©e de Fourier de
$|S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)$
au point $(x\cos\theta + y\sin\theta,\theta)$.
Nous pouvons alors voir que l'√©quation (7.4) est en fait √©gale √†
\[
\frac{1}{2\pi} \int_{0}^{\pi}
\mathcal{F}^{-1}
\Bigl(
|S|\,\mathcal{F}\bigl(\mathcal{R}f\bigr)(S,\theta)
\Bigr)
\bigl(x\cos\theta + y\sin\theta,\theta\bigr)
\,d\theta.
\]

Finalement, nous constatons que l'int√©grale ci-dessus est √©gale √† $\tfrac{1}{2}$ de la r√©troprojection donn√©e dans la d√©finition \eqref{eq:FBP} pour
$\mathcal{F}^{-1}\bigl[|S|\,\mathcal{F}(\mathcal{R}f)(S,\theta)\bigr]$.
Nous simplifions donc l'√©quation pr√©c√©dente pour obtenir
\[
\frac{1}{2}\,
\mathcal{B}
\Bigl\{
\mathcal{F}^{-1}
\bigl[|S|\,\mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\bigr]
\Bigr\}(x,y).
\]

Ce qui nous conduit √† la conclusion souhait√©e :
\[
f(x,y)
=
\frac{1}{2}\,
\mathcal{B}
\Bigl\{
\mathcal{F}^{-1}
\bigl[|S|\,\mathcal{F}\bigl(\mathcal{R}f(S,\theta)\bigr)\bigr]
\Bigr\}(x,y).
\]
\hfill $\square$\\
Le facteur important dans cette formule est le multiplicateur $|S|$ qui appara√Æt entre la transform√©e de Fourier et son inverse. Sans ce facteur, ces deux termes s'annuleraient mutuellement et nous nous retrouverions avec la formule standard de r√©troprojection pour la transform√©e de Radon que nous avons rencontr√©e pr√©c√©demment et qui, comme nous l'avons vu, ne nous donne pas directement $f(x, y)$. Nous appelons ce $|S|$ suppl√©mentaire un \textbf{filtre} de la transform√©e de Radon, ce qui nous donne le nom de la formule de \textbf{r√©troprojection filtr√©e}.
\begin{proposition}
    Soit $f$ et $g$ deux fonctions int√©grables d√©finies sur $\mathbb{R}$, alors
    \[(\mathcal{B}g\star f)(X, Y) = \mathcal{B}(g\star \mathcal{R}f)(X, Y)\]
\end{proposition}
Consid√©rons maintenant la relation \eqref{eq:FBP_filter} et 
supposons qu'il existe une fonction, not√©e $\varphi(t)$, dont la transform√©e de Fourier
soit √©gale √† notre facteur de filtrage $|S|$. Autrement dit, supposons qu'il existe une
fonction $\varphi(t)$ telle que
\[
\mathcal{F}\varphi(S) = |S|.
\]
Plus simplement, supposons que nous connaissions une fonction dont la transform√©e de
Fourier est √©gale √† la fonction valeur absolue. Nous pourrions alors r√©√©crire la
r√©troprojection sous la forme suivante :
\begin{equation}
    f(x,y) = \frac{1}{2}\,\mathcal{B}
    \left\{
    \mathcal{F}^{-1}
    \bigl[
    \mathcal{F}\varphi \cdot \mathcal{F}(\mathcal{R}f)(S,\theta)
    \bigr]
    \right\}(x,y).
    \label{eq:FBP_varphi}
\end{equation}

Cependant, le membre de droite de l'√©quation \eqref{eq:FBP_varphi} contient un produit de transform√©esde Fourier, que nous savons √™tre √©gal √† la convolution des fonctions transform√©es
\[
    f(x,y)
    =
    \frac{1}{2}\,\mathcal{B}
    \left\{
    \mathcal{F}^{-1}
    \bigl[
    \mathcal{F}(\varphi \star \mathcal{R}f)(S,\theta)
    \bigr]
    \right\}(x,y).
\]

Mais ceci n'est rien d'autre que la transform√©e de Fourier inverse de la transform√©e
de Fourier, ce qui nous ram√®ne √† la fonction de d√©part. Cela nous conduit √† la formule
de r√©troprojection filtr√©e beaucoup plus simple :
\begin{equation}
    f(x,y) = \frac{1}{2}\,\mathcal{B}(\varphi \star \mathcal{R}f)(x,y).
    % \tag{8.2}
    \label{eq:FBP_varphi_simple}
\end{equation}

L'√©quation \eqref{eq:FBP_varphi_simple} est bien plus √©l√©gante que notre formule initiale de r√©troprojection filtr√©e et ne semble pas difficile √† appliquer. Physiquement parlant, $\mathcal{R}f$ repr√©sente nos donn√©es mesur√©es et l'√©quation \eqref{eq:FBP_varphi_simple} requiert simplement de les filtrer √† l'aide de notre nouvelle fonction $\varphi$, puis d'appliquer la formule de r√©troprojection, qui est une int√©grale relativement simple.

Malheureusement, il n'existe pas de fonction $\varphi$ dont la transform√©e de Fourier
soit exactement √©gale √† la valeur absolue. Consid√©rons la fonction $\mathcal{F}\varphi$ :
\[
\mathcal{F}\varphi(\omega)
=
\int_{-\infty}^{\infty}
\varphi(x)\,e^{-i\omega x}\,dx.
\]

Nous pouvons constater que, lorsque $\omega \to \infty$,
$\mathcal{F}\varphi(\omega) \to 0$ (remarquons l'exponentielle n√©gative).
Cependant, pour la fonction valeur absolue $|\omega|$, lorsque $\omega \to \infty$,
$|\omega| \to \infty$.
Par cons√©quent, il est impossible de trouver une fonction $\varphi$ telle que,
pour tout $\omega$, $\mathcal{F}\varphi(\omega) = |\omega|$.

Toutefois, tout notre travail pr√©c√©dent n'est pas vain. Examinons plut√¥t le type de
fonctions sur lesquelles nous avons restreint notre √©tude. Nous ne consid√©rons notre
fonction que sur un intervalle fini et supposons en fait qu'elle soit nulle en dehors
de cet intervalle. En √©tendant cette id√©e √† la transform√©e de Fourier, nous constatons
que nous devons porter notre attention sur les \emph{fonctions √† bande limit√©e}.

\begin{definition}
    Une fonction $\varphi$ est dite \emph{√† bande limit√©e} s'il existe un r√©el $L > 0$ tel que
    \begin{equation}
        \mathcal{F}\varphi(\omega)
        =
        \int_{-\infty}^{\infty}
        \varphi(x)\,e^{-i\omega x}\,dx
        =
        0
        \quad \text{pour tout } \omega \notin [-L, L].
        % \tag{8.3}
        \label{eq:FBP_varphi_banded}
    \end{equation}
\end{definition}

Le facteur de filtrage $|S|$ sert √† amplifier le terme $\mathcal{F}(\mathcal{R}f)$ dans la formule de r√©troprojection filtr√©e originale \eqref{eq:FBP_filter}. En pratique, $\mathcal{F}(\mathcal{R}f)$ est tr√®s sensible aux hautes fr√©quences.

En concentrant notre attention sur les basses fr√©quences √† l'aide d'une fonction √† bande limit√©e $\varphi$, nous sommes en mesure d'√©viter ce probl√®me. Notre objectif est de remplacer $S$ par ce que l'on appelle un \emph{filtre passe-bas} (not√© $S'$), qui prend en compte les effets des basses fr√©quences tout en att√©nuant les hautes fr√©quences. Cette fonction $S'$ doit avoir un support compact et √™tre de la forme
\[
S' = \mathcal{F}\varphi
\]
(sur un intervalle compact).

Le co√ªt de l'utilisation de $S'(\omega)$ est que nous ne disposons plus de l'√©galit√© pr√©sent√©e dans l'√©quation \eqref{eq:FBP_varphi_simple}. En revanche, nous obtenons :
\begin{equation}
    f(x,y) \approx \frac{1}{2}\,\mathcal{B}\!\left(\mathcal{F}^{-1} S' \star \mathcal{R}f \right)(x,y).
    \label{eq:FBP_varphi_approx}
\end{equation}

De mani√®re g√©n√©rale, la plupart des filtres passe-bas sont de la forme
\[
S'(\omega) = |\omega| \cdot F(\omega) \cdot \Pi_L(\omega),
\]
o√π $L > 0$ d√©finit la r√©gion sur laquelle le filtrage est effectu√©. Diff√©rentes fonctions $F$ d√©terminent les caract√©ristiques pr√©cises du filtre, et $\Pi_L(\omega)$ est d√©finie comme suit :
\[
    \Pi_L(\omega) =
    \begin{cases}
        1 & \text{si } |\omega| \leq L, \\
        0 & \text{si } |\omega| > L.
    \end{cases}
\]

Nous introduisons maintenant deux filtres couramment utilis√©s en imagerie num√©rique et en traitement du signal : le filtre \emph{Ram-Lak} et le filtre \emph{Hann}.

\subsection*{Filtre Ram-Lak}

Le filtre Ram-Lak est d√©fini par :
\[
S'(\omega) = |\omega| \cdot \Pi_L(\omega) =
\begin{cases}
|\omega| & \text{si } |\omega| \leq L, \\
0 & \text{si } |\omega| > L.
\end{cases}
\]

Le filtre Ram-Lak constitue la base de nombreux autres filtres utilis√©s en analyse du signal, car il remplace simplement la fonction $F(\omega)$ par la fonction constante √©gale √† 1. D'autres filtres, tels que le filtre Hann, consistent g√©n√©ralement en des produits de fonctions sinus ou cosinus destin√©es √† √©liminer le bruit ind√©sirable.

\subsection*{Filtre Hann}

Le filtre Hann est donn√© par :
\[
S'(\omega) = |\omega| \cdot \frac{1}{2}
\left( 1 + \cos\!\left( \frac{2\pi \omega}{L} \right) \right)
\cdot \Pi_L(\omega).
\]

Le filtre Hann utilise la fonction de Hann
\[
\frac{1}{2}\left( 1 + \cos\!\left( \frac{2\pi \omega}{L} \right) \right)
\]
comme fonction $F(\omega)$,
% et son efficacit√© est illustr√©e dans le sinogramme et la r√©troprojection de la transform√©e de Radon de Johann, pr√©sent√©s √† la Figure~5.
% ====== TODO ======
% Python implementation
% ==================

